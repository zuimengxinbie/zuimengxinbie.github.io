---
title: ã€JavaScriptã€‘- ç±»å’Œç»§æ‰¿
date: 2022-01-01 00:00:00
sidebar: auto
sticky: false
permalink: /pages/ts220101/
categories:
  - æŠ€æœ¯
tags:
  - ts
---

<p align="center">
  <img width="500" src="https://p19.qhimg.com/dmfd/2560_1440_/t01c7f8cc90f063193c.jpg"/>
</p>

> å¾…å®Œå–„ï¼Œæ„Ÿè°¢æŒ‡æ•™ ğŸŒ¹ğŸŒ¹ğŸŒ¹
>
> <!-- more -->

# JS è®¾è®¡æ¨¡å¼

## ç±»ã€åŸå‹å’Œç»§æ‰¿

### ES5 ä¸­ç±»çš„ç»§æ‰¿

#### ç±»ï¼ˆæ„é€ å‡½æ•°ï¼‰

æ„é€ å‡½æ•°çš„åå­—é€šå¸¸ç”¨ä½œç±»åï¼Œæ„é€ å‡½æ•°æ˜¯ç±»çš„å…¬æœ‰æ ‡è¯†

```javascript
// Personç±»
function Person(name) {
  // å®ä¾‹å±æ€§
  this.name = name;
  // å®ä¾‹æ–¹æ³•
  this.getName = function () {
    return this.name;
  };
}

// ç±»åˆ›å»ºçš„å¯¹è±¡å«ç±»çš„å®ä¾‹å¯¹è±¡
var person = new Person('ziyi2');
```

ç±»çš„å®ä¾‹å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªä¸å¯æšä¸¾çš„å±æ€§ constructor å±æ€§æŒ‡å‘ç±»ï¼ˆæ„é€ å‡½æ•°ï¼‰

```javascript
// true
console.log(person.constructor === Person);
```

æ„é€ å‡½æ•°æ˜¯ç±»çš„å…¬æœ‰æ ‡è¯†ï¼Œä½†æ˜¯åŸå‹æ˜¯ç±»çš„å”¯ä¸€æ ‡è¯†

```javascript
// æ£€æµ‹å®ä¾‹å¯¹è±¡æ‰€åœ¨çš„ç±» true
// å®é™…ä¸Šinstanceofè¿ç®—ç¬¦å¹¶ä¸ä¼šæ£€æµ‹personæ˜¯å¦ç”±Person()æ„é€ å‡½æ•°åˆå§‹åŒ–è€Œæ¥
// è€Œæ˜¯ä¼šæ£€æŸ¥personæ˜¯å¦ç»§æ‰¿è‡ªPerson.prototype
console.log(person instanceof Person);
// ç»§æ‰¿è‡³åŸå‹é“¾é¡¶ç«¯çš„Objectç±» true
console.log(person instanceof Object);
```

æ‰€æœ‰å®ä¾‹çš„å®ä¾‹æ–¹æ³•å¹¶ä¸æ˜¯åŒä¸€ä¸ª

```javascript
var person1 = new Person('ziyi1');
// åˆ›å»ºä¸€ä¸ªå®ä¾‹å¯¹è±¡å°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ç‰©ç†ç©ºé—´ false
console.log(person1.getName === person.getName);
```

å¦‚æœä¸ç”¨ new å…³é”®å­—ï¼ŒPerson æ˜¯ä¸€ä¸ªæ™®é€šçš„å…¨å±€ä½œç”¨åŸŸä¸­çš„å‡½æ•°

```javascript
Person('ziyi2');
// å…¨å±€ä½œç”¨åŸŸä¸­è°ƒç”¨å‡½æ•°çš„thisæŒ‡å‘windowå…¨å±€å¯¹è±¡ ziyi2
console.log(window.name);
// ziyi2
console.log(window.getName());
```

æ³¨æ„ç±»çš„é™æ€å±æ€§å’Œé™æ€æ–¹æ³•å’Œå®ä¾‹çš„å±æ€§å’Œæ–¹æ³•çš„åŒºåˆ«

```javascript
// ç±»å±æ€§
Person.age = 23;
// ç±»æ–¹æ³•
Person.getAge = function () {
  return this.age;
};
```

æ„é€ å‡½æ•°åˆ›å»ºå®ä¾‹å¯¹è±¡çš„è¿‡ç¨‹å’Œå·¥å‚æ¨¡å¼ç±»ä¼¼

```javascript
function createPerson(name) {
  var person = new Object();
  person.name = name;
  person.getName = function () {
    return this.name;
  };
  return person;
}

let person1 = createPerson('ziyi1');
let person2 = createPerson('ziyi2');
// false
console.log(person1.getName === person2.getName);
```

> å·¥å‚æ¨¡å¼è™½ç„¶æŠ½è±¡äº†åˆ›å»ºå…·ä½“å¯¹è±¡çš„è¿‡ç¨‹ï¼Œè§£å†³äº†åˆ›å»ºå¤šä¸ªç›¸ä¼¼å¯¹è±¡çš„é—®é¢˜ï¼Œä½†æ˜¯æ²¡æœ‰è§£å†³å¯¹è±¡çš„è¯†åˆ«é—®é¢˜ï¼Œå³å¦‚ä½•çŸ¥é“å¯¹è±¡çš„ç±»å‹ï¼Œè€Œç±»ï¼ˆæ„é€ å‡½æ•°ï¼‰åˆ›å»ºçš„å®ä¾‹å¯¹è±¡å¯ä»¥è¯†åˆ«å®ä¾‹å¯¹è±¡å¯¹åº”å“ªä¸ªåŸå‹å¯¹è±¡ï¼ˆéœ€è¦æ³¨æ„åŸå‹å¯¹è±¡æ˜¯ç±»çš„å”¯ä¸€æ ‡è¯†ï¼Œå½“ä¸”ä»…å½“ä¸¤ä¸ªå¯¹è±¡ç»§æ‰¿è‡ªåŒä¸€ä¸ªåŸå‹å¯¹è±¡ï¼Œæ‰å±äºåŒä¸€ä¸ªç±»çš„å®ä¾‹ï¼Œè€Œæ„é€ å‡½æ•°å¹¶ä¸èƒ½ä½œä¸ºç±»çš„å”¯ä¸€æ ‡è¯†ï¼‰ã€‚

æ„é€ å‡½æ•°çš„åˆ›å»ºè¿‡ç¨‹

- åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡
- å°†æ„é€ å‡½æ•°çš„ä½œç”¨åŸŸèµ‹ç»™æ–°å¯¹è±¡ï¼ˆthis æ–°å¯¹è±¡ï¼‰
- æ‰§è¡Œæ„é€ å‡½æ•°ä¸­çš„ä»£ç 
- è¿”å›æ–°å¯¹è±¡ï¼ˆæœ€ç»ˆè¿”å›çš„å°±æ˜¯ new å‡ºæ¥çš„å®ä¾‹å¯¹è±¡ï¼Œå› æ­¤ this æŒ‡å‘å®ä¾‹å¯¹è±¡ï¼‰

#### åŸå‹

##### åŸå‹ç‰¹æ€§

```javascript
// Personç±»ï¼ˆæ„é€ å‡½æ•°ã€Functionç±»çš„å®ä¾‹å¯¹è±¡ã€å‡½æ•°ï¼‰
function Person(name) {
  this.name = name;
}
// Personç±»æ˜¯ä¸€ä¸ªFunctionç±»çš„å®ä¾‹ true
// Personç»§æ‰¿è‡ªFunction
console.log(Person instanceof Function);
```

åªè¦åˆ›å»ºä¸€ä¸ªç±»ï¼ˆæ„é€ å‡½æ•°ã€Function ç±»çš„å®ä¾‹å¯¹è±¡ã€å‡½æ•°ï¼‰ï¼Œå°±ä¼šä¸ºç±»åˆ›å»ºä¸€ä¸ª prototype å±æ€§ï¼Œè¿™ä¸ªå±æ€§æŒ‡å‘ç±»çš„åŸå‹å¯¹è±¡ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŸå‹å¯¹è±¡ä¼šè‡ªåŠ¨è·å¾—ä¸€ä¸ª constructorï¼ˆæ„é€ å‡½æ•°ï¼‰å±æ€§ï¼Œè¿™ä¸ªå±æ€§å¯¹åº”ç±»æœ¬èº«ï¼ˆæ„é€ å‡½æ•°ï¼‰

```javascript
console.log(Person.prototype.constructor === Person);
```

ç±»çš„æ‰€æœ‰å®ä¾‹å…±äº«ä¸€ä¸ªåŸå‹å¯¹è±¡ï¼Œå¦‚æœå®ä¾‹å¯¹è±¡çš„æ–¹æ³•å¯ä»¥é€šç”¨ï¼Œå¯ä»¥é€šè¿‡åŸå‹å¯¹è±¡å…±äº«æ–¹æ³•ï¼Œè€Œä¸éœ€è¦ä¸ºæ¯ä¸€ä¸ªå®ä¾‹å¯¹è±¡å¼€è¾Ÿä¸€ä¸ªéœ€è¦ä½¿ç”¨çš„å®ä¾‹æ–¹æ³•ã€‚

```javascript
// åŸå‹å¯¹è±¡çš„æ–¹æ³•
Person.prototype.getName = function () {
  return this.name;
};
// Personç±»çš„å®ä¾‹å¯¹è±¡
var person = new Person('ziyi2');
var person1 = new Person('ziyi1');
// ä¸¤ä¸ªå®ä¾‹å¯¹è±¡å¼•ç”¨çš„æ˜¯åŒä¸€ä¸ªåŸå‹æ–¹æ³• true
console.log(person1.getName === person.getName);
```

å½“è°ƒç”¨æ„é€ å‡½æ•°åˆ›å»ºæ–°å®ä¾‹åï¼Œè¯¥å®ä¾‹å†…éƒ¨å°†åŒ…å«ä¸€ä¸ªæŒ‡å‘æ„é€ å‡½æ•°åŸå‹å¯¹è±¡çš„[[Prototype]] å†…éƒ¨å±æ€§ï¼Œè„šæœ¬ä¸­æ²¡æœ‰æ ‡å‡†çš„æ–¹å¼è®¿é—®[[Prototype]]ï¼Œä½†åœ¨ä¸€äº›æµè§ˆå™¨è¯¸å¦‚ Firefoxã€Safariã€Chrome åœ¨æ¯ä¸ªå¯¹è±¡ä¸Šéƒ½æ”¯æŒå±æ€§**proto**ï¼Œè¿™ä¸ªå¼•ç”¨å­˜åœ¨äºå®ä¾‹ä¸æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ä¹‹é—´ï¼Œè°ƒç”¨æ„é€ å‡½æ•°åˆ›å»ºçš„å®ä¾‹éƒ½æœ‰[[Prototype]]å±æ€§ï¼Œä½†æ˜¯æ— æ³•è®¿é—®ï¼Œå¯ä»¥é€šè¿‡ isPrototypeOf()æ–¹æ³•æ¥ç¡®å®šåŸå‹å¯¹è±¡æ˜¯å¦å¯¹åº”å½“å‰å®ä¾‹å¯¹è±¡

```javascript
// true
console.log(person.__proto__ === Person.prototype);
// true
console.log(Person.prototype.isPrototypeOf(person));
```

è¯»å–åŸå‹é“¾çš„æ–¹æ³•å’Œå±æ€§æ—¶ï¼Œä¼šå‘ä¸Šéå†æœç´¢ï¼Œé¦–å…ˆæœç´¢å®ä¾‹å¯¹è±¡æœ¬èº«æœ‰æ²¡æœ‰åŒåå±æ€§å’Œæ–¹æ³•ï¼Œæœ‰åˆ™è¿”å›ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™ç»§ç»­æœç´¢å®ä¾‹å¯¹è±¡å¯¹åº”çš„åŸå‹å¯¹è±¡çš„æ–¹æ³•å’Œå±æ€§ã€‚

```javascript
// Personç±»çš„åŸå‹å¯¹è±¡çš„å±æ€§
// éœ€è¦æ³¨æ„åŸå‹å¯¹è±¡å…·æœ‰åŠ¨æ€æ€§
// å…ˆåˆ›é€ å®ä¾‹å¯¹è±¡åä¿®æ”¹åŸå‹å¯¹è±¡ä¹Ÿèƒ½å¤Ÿç«‹å³ç”Ÿæ•ˆ
Person.prototype.age = 28;
// è·å–åŸå‹å¯¹è±¡çš„å±æ€§ 28
console.log(person.age);
// æ£€æµ‹å±æ€§æ˜¯å¦å­˜åœ¨äºå®ä¾‹å¯¹è±¡ä¸­ false
console.log(person.hasOwnProperty('age'));
// ç»™å®ä¾‹å¯¹è±¡èµ‹å€¼å±æ€§
person.age = 11;
// è·å–äº†å®ä¾‹å¯¹è±¡çš„å±æ€§ 11
console.log(person.age);
// æ£€æµ‹å±æ€§æ˜¯å¦å­˜åœ¨äºå®ä¾‹å¯¹è±¡ä¸­ true
console.log(person.hasOwnProperty('age'));
// åˆ é™¤å®ä¾‹å¯¹è±¡çš„å±æ€§
delete person.age;
// ä»ç„¶å¯ä»¥é‡æ–°è·å–åŸå‹å¯¹è±¡çš„å±æ€§ 28
console.log(person.age);
// æ£€æµ‹å±æ€§æ˜¯å¦å­˜åœ¨äºå®ä¾‹å¯¹è±¡ä¸­ false
console.log(person.hasOwnProperty('age'));

// åˆ¤æ–­å±æ€§å­˜åœ¨äºå®ä¾‹å¯¹è±¡è¿˜æ˜¯åŸå‹å¯¹è±¡ï¼ˆä¹Ÿå¯èƒ½å±æ€§ä¸å­˜åœ¨ï¼‰
function hasPrototypePrpperty(obj, property) {
  // inå¯ä»¥æ£€æµ‹åˆ°å®ä¾‹å¯¹è±¡å’ŒåŸå‹å¯¹è±¡ä¸­çš„å±æ€§
  return !obj.hasOwnProperty(property) && property in obj;
}

// for...inå¾ªç¯
// è¿”å›æ‰€æœ‰èƒ½å¤Ÿé€šè¿‡å¯¹è±¡è®¿é—®ã€å¯æšä¸¾çš„(enumerated)å±æ€§ï¼ŒåŒ…æ‹¬å®ä¾‹å’ŒåŸå‹å¯¹è±¡çš„ä¸­çš„å±æ€§
for (let key in person) {
  // nameã€age
  // nameæ˜¯å®ä¾‹å¯¹è±¡çš„å±æ€§
  // ageæ˜¯åŸå‹å¯¹è±¡çš„å±æ€§
  console.log(key);
}

// Object.keys()
// è¿”å›æ‰€æœ‰å¯æšä¸¾çš„å®ä¾‹å¯¹è±¡çš„å±æ€§
// ['name']
console.log(Object.keys(person));
```

åˆ›å»ºç±»çš„æ—¶å€™é»˜è®¤ä¼šç»™ç±»åˆ›å»ºä¸€ä¸ª prototype å±æ€§ï¼Œæ˜¯ç±»çš„åŸå‹å¯¹è±¡çš„å¼•ç”¨ï¼Œä¹Ÿå¯ä»¥é‡å†™æ”¹ç±»çš„åŸå‹å¯¹è±¡

```javascript
function Person(name) {
  this.name = name;
}

Person.prototype = {
  getName: function () {
    return this.name;
  },
};

let person = new Person('ziyi2');
// æ­¤æ—¶Personç±»åŸå‹å¯¹è±¡æ˜¯ä¸€ä¸ªæ–°çš„å¯¹è±¡
// æ³¨æ„å’ŒPerson.prototype.getNameçš„åŒºåˆ«
// è¿™ä¸ªæ–°çš„å¯¹è±¡çš„constructorå±æ€§å¯¹åº”Objectç±»
console.log(Person.prototype.constructor === Object);

Person.prototype = {
  // ä½¿æ–°çš„åŸå‹å¯¹è±¡çš„constructorå±æ€§å¯¹åº”Personç±»
  constructor: Person,
  getName: function () {
    return this.name;
  },
};

// true
console.log(Person.prototype.constructor === Person);

// æ³¨æ„æœªé‡å†™åŸå‹å¯¹è±¡ä¹‹å‰çš„å®ä¾‹ä»ç„¶æŒ‡å‘æœªé‡å†™å‰çš„åŸå‹å¯¹è±¡
for (let key in person) {
  // name,getName
  console.log(key);
}

let person1 = new Person('ziyi1');

// é‡å†™çš„åŸå‹å¯¹è±¡çš„constructorå±æ€§å˜æˆäº†å¯æšä¸¾å±æ€§
for (let key in person1) {
  // name,constructor,getName
  console.log(key);
}

// å°†constructorå±æ€§é…ç½®æˆä¸å¯æšä¸¾å±æ€§
Object.defineProperty(Person.prototype, 'constructor', {
  enumerable: false,
  value: Person,
});

for (let key in person1) {
  // name,getName
  console.log(key);
}
```

##### åŸå‹çš„å¼Šç«¯

åŸå‹å¯¹è±¡çš„åŸºæœ¬ç±»å‹æ•°æ®çš„å±æ€§ï¼ˆå­˜æ”¾çš„æ˜¯å…·ä½“çš„å€¼ï¼Œå› æ­¤æ¯ä¸ªå®ä¾‹å¯¹è±¡çš„è¯¥å±æ€§å€¼çš„æ”¹å˜äº’ä¸å½±å“ï¼‰çš„å…±äº«å¯¹äºå®ä¾‹å¯¹è±¡è€Œè¨€éå¸¸ä¾¿æ·æœ‰æ•ˆï¼Œä½†æ˜¯åŸå‹å¯¹è±¡çš„å¼•ç”¨ç±»å‹å±æ€§ä¸åŒï¼ŒåŸå‹å¯¹è±¡çš„å¼•ç”¨ç±»å‹çš„å±æ€§å­˜æ”¾çš„æ˜¯ä¸€ä¸ªæŒ‡é’ˆ(C è¯­è¨€ä¸­çš„æŒ‡é’ˆçš„æ„æ€ï¼ŒæŒ‡é’ˆå­˜æ”¾çš„æ˜¯ä¸€ä¸ªåœ°å€ï¼Œå¹¶ä¸æ˜¯å­˜æ”¾ä¸€ä¸ªå…·ä½“çš„å€¼ï¼Œå› ä¸ºç±»ä¼¼æ•°ç»„ç­‰å€¼åœ¨ä¸€ä¸ª 32bit çš„ç‰©ç†å—ä¸­æ˜¯æ”¾ä¸ä¸‹çš„ï¼Œè‚¯å®šæ˜¯æ”¾åœ¨ä¸€ä¸ªè¿ç»­çš„ç‰©ç†å—ä¸­ï¼Œå› æ­¤éœ€è¦ä¸€ä¸ªåœ°å€å»è¯»å–è¿™äº›è¿ç»­çš„ç‰©ç†å—)ï¼ŒæŒ‡é’ˆæœ€ç»ˆæŒ‡å‘çš„æ˜¯ä¸€ä¸ªè¿ç»­çš„ç‰©ç†å—ï¼Œå› æ­¤é€šè¿‡åŸå‹å¯¹è±¡çš„å¼•ç”¨ç±»å‹ä¿®æ”¹çš„å€¼éƒ½æ˜¯æ”¹å˜è¿™ä¸ªç‰©ç†å—ä¸­çš„å€¼ï¼Œå› æ­¤æ‰€æœ‰å®ä¾‹å¯¹è±¡çš„è¯¥æŒ‡å‘éƒ½ä¼šå‘ç”Ÿå˜åŒ–ã€‚

```javascript
function Person(name) {
  this.name = name;
}

Person.prototype = {
  constructor: Person,
  getName: function () {
    return this.name;
  },
  age: 28,
  names: ['ziyi', 'ziyi1', 'ziyi2'],
};

var person = new Person();
person.names[0] = 'ziyi_modify';
person.age = 11;
var person1 = new Person();
// ["ziyi_modify", "ziyi1", "ziyi2"]
console.log(person1.names);
// 28
console.log(person1.age);
```

##### ç»„åˆæ„é€ å‡½æ•°å’ŒåŸå‹æ¨¡å¼

æ„é€ å‡½æ•°å®šä¹‰å®ä¾‹å±æ€§ï¼ŒåŸå‹å¯¹è±¡å®šä¹‰å…±äº«çš„æ–¹æ³•å’ŒåŸºæœ¬æ•°æ®ç±»å‹çš„å±æ€§

```javascript
function Person(name) {
  this.name = name;
  this.names = ['ziyi', 'ziyi1', 'ziyi2'];
}

Person.prototype = {
  constructor: Person,
  getName: function () {
    return this.name;
  },
};

var person = new Person();
person.names[0] = 'ziyi_modify';
var person1 = new Person();
// ['ziyi', 'ziyi1', 'ziyi2']
console.log(person1.names);
```

#### ç»§æ‰¿

ç»§æ‰¿åˆ†ä¸ºæ¥å£ç»§æ‰¿å’Œå®ç°ç»§æ‰¿ï¼ŒECMAScript åªæ”¯æŒå®ç°ç»§æ‰¿ï¼Œå®ç°ç»§æ‰¿ä¸»è¦ä¾é åŸå‹é“¾ã€‚

##### åŸå‹é“¾

å‡è®¾æœ‰ä¸¤ä¸ªç±»ï¼ˆSon ç±»å’Œ Father ç±»ï¼‰ï¼ŒSon ç±»å¯¹åº”ä¸€ä¸ªåŸå‹å¯¹è±¡ï¼Œé€šè¿‡ Son ç±»åˆ›å»ºçš„å®ä¾‹å¯¹è±¡éƒ½åŒ…å«ä¸€ä¸ªæŒ‡å‘ Son ç±»åŸå‹å¯¹è±¡çš„å†…éƒ¨æŒ‡é’ˆ[[Prototype]](å¤§éƒ¨åˆ†æµè§ˆå™¨æ”¯æŒå®ä¾‹å¯¹è±¡çš„**proto**å±æ€§è®¿é—®åŸå‹å¯¹è±¡)ã€‚å‡å¦‚è®© Son ç±»çš„åŸå‹å¯¹è±¡å¼•ç”¨ Father ç±»çš„å®ä¾‹å¯¹è±¡ï¼Œåˆ™ Son ç±»çš„åŸå‹å¯¹è±¡å°†åŒ…å«ä¸€ä¸ªæŒ‡å‘ Father ç±»çš„åŸå‹å¯¹è±¡çš„å†…éƒ¨æŒ‡é’ˆ[[Prototype]]ï¼Œä»è€Œä½¿ Son ç±»çš„åŸå‹å¯¹è±¡å¯ä»¥å…±äº« Father ç±»åŸå‹å¯¹è±¡å’Œå®ä¾‹å¯¹è±¡ï¼ˆæ³¨æ„è¿™é‡Œä¹ŸåŒ…æ‹¬å®ä¾‹å¯¹è±¡ï¼‰çš„æ–¹æ³•å’Œå±æ€§ï¼Œä»è€Œåˆä½¿ Son ç±»çš„å®ä¾‹å¯¹è±¡å¯ä»¥å…±äº« Father ç±»åŸå‹å¯¹è±¡çš„æ–¹æ³•å’Œå±æ€§ï¼Œè¿™å°±æ˜¯åŸå‹é“¾ã€‚

åŸå‹é“¾å®ç°äº†æ–¹æ³•å’Œå±æ€§çš„ç»§æ‰¿ï¼Œæ­¤æ—¶ Son ç±»æ˜¯å­ç±»ï¼Œç»§æ‰¿äº† Father ç±»è¿™ä¸ªçˆ¶ç±»ã€‚

```javascript
function Father() {
  this.names = ['ziyi', 'ziyi1', 'ziyi2'];
}
function Son() {}

Father.prototype.getName = function () {
  return Father.name;
};

// Sonç±»çš„åŸå‹å¯¹è±¡åŒ…å«äº†Fatherç±»åŸå‹å¯¹è±¡çš„æ–¹æ³•å’Œå±æ€§
// åŒæ—¶ä¹ŸåŒ…å«äº†Fatherç±»å®ä¾‹å¯¹è±¡çš„å®ä¾‹æ–¹æ³•å’Œå®ä¾‹å±æ€§
Son.prototype = new Father();

// é‡å†™äº†Sonç±»çš„åŸå‹å¯¹è±¡
// Son.prototype.constructor !== Son
// true
console.log(Son.prototype.constructor === Father);

let son = new Son();

// ç»§æ‰¿Fatherç±»å®ä¾‹å¯¹è±¡çš„å¼•ç”¨ç±»å‹å±æ€§
// ["ziyi", "ziyi1", "ziyi2"]
console.log(son.names);

// ç»§æ‰¿Fatherç±»åŸå‹å¯¹è±¡çš„æ–¹æ³•
console.log(son.getName());
```

> è¯»å–å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•æ—¶ï¼Œä¼šæ‰§è¡Œæœç´¢ï¼Œé¦–å…ˆæœç´¢å®ä¾‹å¯¹è±¡æœ¬èº«æœ‰æ²¡æœ‰åŒåçš„å±æ€§å’Œæ–¹æ³•ï¼Œæœ‰åˆ™è¿”å›, å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œé‚£ä¹ˆç»§ç»­æœç´¢åŸå‹å¯¹è±¡ï¼Œåœ¨åŸå‹å¯¹è±¡ä¸­æŸ¥æ‰¾å…·æœ‰ç»™å®šåå­—çš„å±æ€§å’Œæ–¹æ³•ã€‚

å®ç°åŸå‹é“¾ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯æ‰©å±•äº†åŸå‹æœç´¢æœºåˆ¶

- æœç´¢å®ä¾‹
- æœç´¢å®ä¾‹çš„åŸå‹ï¼ˆè¯¥åŸå‹åŒæ—¶ä¹Ÿæ˜¯å¦ä¸€ä¸ªç±»çš„å®ä¾‹ï¼‰
- æœç´¢å®ä¾‹çš„åŸå‹çš„åŸå‹
- ...

ä¸€ç›´å‘ä¸Šæœç´¢ï¼Œç›´åˆ°ç¬¬ä¸€æ¬¡æœç´¢åˆ°å±æ€§æˆ–è€…æ–¹æ³•ä¸ºæ­¢ï¼Œæœç´¢ä¸åˆ°ï¼Œåˆ°åŸå‹é“¾çš„æœ«ç«¯åœæ­¢ã€‚

è¯¥ç»§æ‰¿æ–¹æ³•æœ‰ä¸€ä¸ªç¼ºé™·ï¼Œå…·ä½“å¯ä»¥æŸ¥çœ‹åŸå‹çš„å¼Šç«¯ï¼Œåœ¨åŸå‹ä¸­ä½¿ç”¨å¼•ç”¨ç±»å‹çš„å±æ€§ï¼Œåœ¨æ‰€æœ‰çš„å®ä¾‹å¯¹è±¡ä¸­çš„è¯¥å±æ€§éƒ½å¼•ç”¨äº†åŒä¸€ä¸ªç‰©ç†ç©ºé—´ï¼Œä¸€æ—¦ç©ºé—´çš„å€¼å‘ç”Ÿäº†å˜åŒ–ï¼Œé‚£ä¹ˆæ‰€æœ‰å®ä¾‹å¯¹è±¡çš„è¯¥å±æ€§å€¼å°±å‘ç”Ÿäº†å˜åŒ–ã€‚

```javascript
// sonå®ä¾‹å¯¹è±¡ä¿®æ”¹Fatherç±»å®ä¾‹å¯¹è±¡ï¼ˆSonç±»çš„åŸå‹å¯¹è±¡ï¼‰çš„å¼•ç”¨ç±»å‹å±æ€§
son.names.push('ziyi3');
let son1 = new Son();
// son1ä¸­ä»ç„¶å¼•ç”¨çš„æ˜¯Fatherç±»å®ä¾‹å¯¹è±¡ï¼ˆSonç±»çš„åŸå‹å¯¹è±¡ï¼‰çš„å¼•ç”¨ç±»å‹å±æ€§
// ["ziyi", "ziyi1", "ziyi2", "ziyi3"]
console.log(son1.names);
```

##### å€Ÿç”¨æ„é€ å‡½æ•°ï¼ˆä¼ªé€ å¯¹è±¡æˆ–ç»å…¸ç»§æ‰¿ï¼‰

ä¸ºäº†é¿å¼€åŸå‹ä¸­æœ‰å¼•ç”¨ç±»å‹æ•°æ®çš„é—®é¢˜ï¼Œåšåˆ°å­ç±»ç»§æ‰¿ï¼ˆè¿™é‡Œçš„ç»§æ‰¿åªæ˜¯åˆ›å»ºå’Œçˆ¶ç±»ç›¸åŒçš„å®ä¾‹å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ï¼‰çˆ¶ç±»çš„å®ä¾‹å¯¹è±¡çš„å®ä¾‹æ–¹æ³•å’Œå®ä¾‹å±æ€§ï¼Œåœ¨å­ç±»çš„æ„é€ å‡½æ•°ä¸­è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œä»è€Œä½¿å­ç±»çš„ this å¯¹è±¡åœ¨çˆ¶ç±»æ„é€ å‡½æ•°ä¸­æ‰§è¡Œï¼Œå¹¶æœ€ç»ˆè¿”å›çš„æ˜¯å­ç±»çš„ this å¯¹è±¡ï¼ˆæˆ‘ä»¬çŸ¥é“å­ç±»çš„ this å¯¹è±¡åœ¨æ„é€ å‡½æ•°çš„æ‰§è¡Œè¿‡ç¨‹ä¸­éƒ½æ˜¯å¼€è¾Ÿæ–°çš„å¯¹è±¡ç©ºé—´ï¼Œå› æ­¤å¼•ç”¨ç±»å‹çš„å®ä¾‹å±æ€§éƒ½æ˜¯ä¸åŒçš„æŒ‡é’ˆåœ°å€ï¼‰ã€‚

```javascript
function Father() {
  this.names = ['ziyi', 'ziyi1', 'ziyi2'];
}
function Son() {
  // ä½¿ç”¨newå…³é”®å­—æ‰§è¡Œçš„æ„é€ å‡½æ•°thisæŒ‡å‘å®ä¾‹å¯¹è±¡
  // æ³¨æ„å¦‚æœä¸ç”¨newå…³é”®å­—æ‰§è¡ŒthisæŒ‡å‘å…¨å±€å¯¹è±¡window
  // è¿™é‡Œçš„Fatherç±»å½“åšä¸€ä¸ªæ™®é€šçš„æ‰§è¡Œå‡½æ•°
  // æ­¤æ—¶åªæ˜¯è®©Sonç±»çš„å®ä¾‹å¯¹è±¡åˆ›å»ºäº†å’ŒFatherç±»å®ä¾‹å¯¹è±¡ä¸€æ ·çš„å®ä¾‹å±æ€§å’Œå®ä¾‹æ–¹æ³•
  Father.call(this);

  // Father.call(this)ç±»ä¼¼äºåœ¨Sonæ„é€ å‡½æ•°ä¸­æ‰§è¡Œ
  // this.names = ['ziyi','ziyi1', 'ziyi2']
}

let son = new Son();
son.names.push('ziyi3');
// ["ziyi", "ziyi1", "ziyi2", "ziyi3"]
console.log(son.names);

let son1 = new Son();
// ['ziyi','ziyi1', 'ziyi2']
console.log(son1.names);
```

å¦‚æœæ­¤æ—¶çˆ¶ç±»æœ‰è‡ªå·±çš„å®ä¾‹å±æ€§ï¼Œè€Œå­ç±»ä¹Ÿæœ‰è‡ªå·±çš„å®ä¾‹å±æ€§

```javascript
function Father(name, age) {
  this.name = name;
  this.age = age;
}
function Son() {
  Father.apply(this, arguments);
  this.job = arguments[2];
}

let son = new Son('ziyi2', 28, 'web');
// {name: "ziyi2", age: 28, job: "web"}
console.log(son);
```

##### ç»„åˆç»§æ‰¿

ä¸ºäº†é˜²æ­¢åŸå‹å¯¹è±¡å¼•ç”¨ç±»å‹åœ¨å®ä¾‹å¯¹è±¡ä¸­æ˜¯åŒä¸€ä¸ªæŒ‡é’ˆçš„é—®é¢˜ï¼Œåœ¨åŸå‹é“¾çš„å®ç°ä¸­å¯ä»¥æ··åˆå€Ÿç”¨æ„é€ å‡½æ•°å®ç°ç»„åˆç»§æ‰¿

```javascript
function Father(name, age) {
  this.name = name;
  this.age = age;
  // å¼•ç”¨ç±»å‹çš„å®ä¾‹å±æ€§
  this.names = [];
}

Father.prototype.getNames = function () {
  return this.names;
};

function Son(name, age, job) {
  // å€Ÿç”¨æ„é€ å‡½æ•°
  // thisæ‰§è¡Œçš„è¿‡ç¨‹ä¸­ä¹Ÿä¼šåˆ›å»ºthis.nameså®ä¾‹å±æ€§
  Father.call(this, name, age);
  this.job = job;
}

// åˆ›å»ºåŸå‹é“¾
// éœ€è¦æ³¨æ„æ­¤æ—¶Sonç±»çš„åŸå‹å¯¹è±¡ä¸­è¿˜æ˜¯æœ‰Fatherç±»çš„å®ä¾‹å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•
Son.prototype = new Father();
// è°ƒæ•´SonåŸå‹å¯¹è±¡çš„constructoræŒ‡å‘
Son.prototype.constructor = Son;

let son = new Son('ziyi2', 28, 'web');
son.names.push('ziyi2');
// { age:28 job:"web" name:"ziyi2" names:["ziyi2"] }
console.log(son);
let son1 = new Son('ziyi2', 28, 'web');
// [] son.nameå’Œson1.namesæ˜¯ä¸åŒçš„æŒ‡é’ˆï¼ŒæŒ‡å‘ä¸åŒçš„ç‰©ç†ç©ºé—´
console.log(son1.names);
```

> éœ€è¦æ³¨æ„çš„æ˜¯ Son ç±»çš„å®ä¾‹å¯¹è±¡ä¸­æœ‰ nameã€age å’Œ names å±æ€§ï¼ŒSon ç±»çš„åŸå‹å¯¹è±¡ä¸­ä¹Ÿæœ‰è¿™äº›å±æ€§ï¼Œåªæ˜¯æ ¹ç»åŸå‹é“¾çš„æœç´¢æœºåˆ¶ï¼Œåœ¨ä½¿ç”¨å®ä¾‹å¯¹è±¡è®¿é—®è¿™äº›å±æ€§æ—¶ï¼Œé¦–å…ˆæœç´¢äº†å®ä¾‹å¯¹è±¡ä¸­çš„è¯¥åŒåå±æ€§ï¼Œå› æ­¤åŸå‹å¯¹è±¡ä¸­çš„è¯¥å±æ€§è¢«å±è”½ã€‚

```javascript
// undefined
console.log(Son.prototype.age);
// undefined
console.log(Son.prototype.name);
// []
console.log(Son.prototype.names);
```

##### å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿

| ç±»å‹         | ä¼˜ç¼ºç‚¹                                                                                                                                                       |
| :----------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------- |
| æ„é€ å‡½æ•°æ¨¡å¼ | å¯ä»¥åˆ›å»ºä¸åŒå®ä¾‹å±æ€§çš„å‰¯æœ¬ï¼ŒåŒ…æ‹¬å¼•ç”¨ç±»å‹çš„å®ä¾‹å±æ€§ï¼Œä½†æ˜¯ä¸èƒ½å…±äº«æ–¹æ³•                                                                                         |
| åŸå‹æ¨¡å¼     | å¼•ç”¨ç±»å‹çš„å±æ€§å¯¹äºå®ä¾‹å¯¹è±¡è€Œè¨€å…±äº«åŒä¸€ä¸ªç‰©ç†ç©ºé—´ï¼Œå› æ­¤å¯ä»¥å…±äº«æ–¹æ³•                                                                                           |
| åŸå‹é“¾       | å¯¹çˆ¶ç±»å®ç°æ–¹æ³•å’Œå±æ€§ç»§æ‰¿çš„è¿‡ç¨‹ä¸­ï¼Œçˆ¶ç±»å®ä¾‹å¯¹è±¡çš„å¼•ç”¨ç±»å‹å±æ€§åœ¨å­ç±»çš„å®ä¾‹ä¸­å…±äº«åŒä¸€ä¸ªç‰©ç†ç©ºé—´ï¼Œå› ä¸ºçˆ¶ç±»çš„å®ä¾‹å¯¹è±¡æŒ‡å‘äº†å­ç±»çš„åŸå‹å¯¹è±¡                         |
| å€Ÿç”¨æ„é€ å‡½æ•° | è§£å†³äº†ç»§æ‰¿ä¸­çš„å¼•ç”¨å€¼ç±»å‹å…±äº«ç‰©ç†ç©ºé—´çš„é—®é¢˜ï¼Œä½†æ˜¯æ²¡æ³•å®ç°æ–¹æ³•çš„å…±äº«                                                                                           |
| ç»„åˆç»§æ‰¿     | å±æ€§çš„ç»§æ‰¿ä½¿ç”¨å€Ÿç”¨æ„é€ å‡½æ•°æ–¹æ³•ï¼Œæ–¹æ³•çš„ç»§æ‰¿ä½¿ç”¨åŸå‹é“¾æŠ€æœ¯ï¼Œå³è§£å†³äº†å¼•ç”¨å€¼ç±»å‹å…±äº«çš„é—®é¢˜ï¼Œåˆå®ç°äº†æ–¹æ³•çš„å…±äº«ï¼Œä½†æ˜¯å­ç±»çš„åŸå‹å¯¹è±¡ä¸­è¿˜å­˜åœ¨çˆ¶ç±»å®ä¾‹å¯¹è±¡çš„å®ä¾‹å±æ€§ |

ç›®å‰è€Œè¨€ï¼Œç»„åˆç»§æ‰¿å·²ç»å¯ä»¥è§£å†³å¤§éƒ¨åˆ†é—®é¢˜ï¼Œä½†æ˜¯ä¹Ÿæœ‰ç¼ºé™·ï¼Œå°±æ˜¯ä¼šè°ƒç”¨ä¸¤æ¬¡çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œä¸€æ¬¡æ˜¯å®ç°åŸå‹æ—¶ä½¿å­ç±»çš„åŸå‹ç­‰äºçˆ¶ç±»çš„å®ä¾‹å¯¹è±¡è°ƒç”¨äº†çˆ¶ç±»æ„é€ å‡½æ•°ï¼ˆåŒæ—¶åœ¨å­ç±»çš„åŸå‹å¯¹è±¡ä¸­è¿˜å­˜åœ¨äº†çˆ¶ç±»å®ä¾‹å¯¹è±¡çš„å®ä¾‹å±æ€§ï¼‰ï¼Œä¸€æ¬¡æ˜¯ä½¿ç”¨å­ç±»æ„é€ å‡½æ•°æ—¶è°ƒç”¨äº†ä¸€æ¬¡çˆ¶ç±»æ„é€ å‡½æ•°ã€‚

å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿å¯ä»¥è§£å†³åœ¨ç»§æ‰¿çš„è¿‡ç¨‹ä¸­å­ç±»çš„åŸå‹å¯¹è±¡ä¸­è¿˜å­˜åœ¨çˆ¶ç±»å®ä¾‹å¯¹è±¡çš„å®ä¾‹å±æ€§çš„é—®é¢˜ã€‚

```javascript
// ç»§æ‰¿oåŸå‹å¯¹è±¡çš„æ–¹æ³•å’Œå±æ€§
// éœ€è¦æ³¨æ„oçš„å¼•ç”¨ç±»å‹å±æ€§åœ¨Få®ä¾‹å¯¹è±¡ä¸­å…±äº«åŒä¸€ä¸ªç‰©ç†ç©ºé—´ï¼ˆéœ€è¦é¿å…ä½¿ç”¨å¼•ç”¨ç±»å‹å±æ€§å€¼ï¼‰
// å½“ç„¶oçš„æ–¹æ³•åœ¨Få®ä¾‹å¯¹è±¡ä¸­å…±äº«
function objectCreate(o) {
  // Fç±»æ²¡æœ‰å®ä¾‹æ–¹æ³•å’Œå®ä¾‹å±æ€§
  function F() {}
  F.prototype = o;
  // oæ˜¯Fç±»çš„åŸå‹å¯¹è±¡
  // è¿”å›Fç±»çš„å®ä¾‹å¯¹è±¡
  // new F().__proto__ = o
  // Fç±»å®ä¾‹å¯¹è±¡å…±äº«oçš„å±æ€§å’Œæ–¹æ³•
  // true
  console.log(new F().__proto__ === o);
  return new F();
}

// SubClasså®ç°å¯¹äºSuperClassåŸå‹å¯¹è±¡çš„æ–¹æ³•å’Œå±æ€§çš„ç»§æ‰¿
function inheritPrototype(SubClass, SuperClass) {
  // prototypeæ˜¯ä¸€ä¸ªå®ä¾‹å¯¹è±¡
  // prototypeä¸æ˜¯SuperClassçš„å®ä¾‹å¯¹è±¡è€Œæ˜¯å¦ä¸€ä¸ªç±»Fç±»çš„å®ä¾‹å¯¹è±¡
  // SuperClassç±»å’ŒobjectCreateå‡½æ•°ä¸­çš„Fç±»çš„åŸå‹å¯¹è±¡éƒ½æ˜¯SuperClass.prototype
  // è¿™é‡Œæ²¡æœ‰è°ƒç”¨SuperClassæ„é€ å‡½æ•°
  // prototypeç»§æ‰¿äº†SuperClassç±»çš„åŸå‹å¯¹è±¡çš„æ–¹æ³•å’Œå±æ€§
  var prototype = objectCreate(SuperClass.prototype);
  // ä½¿prototypeå®ä¾‹å¯¹è±¡çš„constructorå±æ€§æŒ‡å‘SubClasså­ç±»
  // å› ä¸ºé‡å†™SuperClassçš„åŸå‹å¯¹è±¡æ—¶ä¼šä¿®æ”¹constructorå±æ€§
  // SubClass.prototype.constructor = SubClass
  prototype.constructor = SubClass;
  // ä½¿SubClassç±»çš„åŸå‹å¯¹è±¡æŒ‡å‘prototypeå®ä¾‹å¯¹è±¡
  // ç±»ä¼¼äºSubClass.prototype = new SuperClass()
  // åªæ˜¯è¿™é‡Œæ˜¯SubClass.prototype = new F()
  // Fç±»æœ¬èº«æ²¡æœ‰å®ä¾‹æ–¹æ³•å’Œå®ä¾‹å±æ€§
  SubClass.prototype = prototype;
}

function Father(name, age) {
  this.name = name;
  this.age = age;
}

Father.prototype.getName = function () {
  return this.name;
};

function Son1(name, age, job) {
  // å€Ÿç”¨æ„é€ å‡½æ•°
  Father.apply(this, arguments);
  this.job = job;
}

function Son2(name, age, job) {
  // å€Ÿç”¨æ„é€ å‡½æ•°
  Father.apply(this, arguments);
  this.job = job;
}

// ç»„åˆç»§æ‰¿çš„å†™æ³•
Son1.prototype = new Father();
Son1.prototype.constructor = Son1;
// age : undefined
// constructor : Æ’ Son1(name, age, job)
// name : undefined
// __proto__ : { getName:Æ’ () constructor : Æ’ Father(name, age) }
console.log(Son1.prototype);

// å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿çš„å†™æ³•
// å€Ÿç”¨æ„é€ å‡½æ•°å®ç°æ„é€ å‡½æ•°çš„æ–¹æ³•å’Œå±æ€§çš„ç»§æ‰¿
// inheritPrototypeå‡½æ•°å®ç°åŸå‹å¯¹è±¡çš„æ–¹æ³•å’Œå±æ€§çš„ç»§æ‰¿
inheritPrototype(Son2, Father);
// constructor : Æ’ Son2(name, age, job)
// __proto__ : { getName:Æ’ () constructor : Æ’ Father(name, age) }
console.log(Son2.prototype);

var son1 = new Son1('ziyi2', 28, 'web');
var son2 = new Son2('ziyi3', 28, 'hardware');
son1.getName();
son2.getName();
```

### ES6 ä¸­ç±»çš„ç»§æ‰¿

#### ç±»

ES6 ä¸­çš„ç±»åªæ˜¯ ES5 å°è£…åçš„è¯­æ³•ç³–è€Œå·²

```javascript
// ES6ä¸­å®ç°çš„Personç±»
class Es6Person {
  constructor(name, age) {
    // å®ä¾‹å¯¹è±¡çš„å±æ€§
    this.name = name;
    this.age = age;
    // å®ä¾‹å¯¹è±¡çš„æ–¹æ³•
    this.getName = () => {
      return this.name;
    };
  }

  // Personç±»åŸå‹å¯¹è±¡çš„æ–¹æ³•
  getAge() {
    return this.age;
  }
}

// ES5ä¸­å®ç°çš„Personç±»
function Es5Person(name, age) {
  // å®ä¾‹å¯¹è±¡çš„å±æ€§
  this.name = name;
  this.age = age;
  // å®ä¾‹å¯¹è±¡çš„æ–¹æ³•
  this.getName = () => {
    return this.name;
  };
}

// Personç±»åŸå‹å¯¹è±¡çš„æ–¹æ³•
Es5Person.prototype.getAge = function () {
  return this.age;
};
```

åœ¨ ES5 ä¸­ç±»çš„åŸå‹å¯¹è±¡çš„æ–¹æ³•æ˜¯å¯æšä¸¾çš„ï¼Œä½†æ˜¯ ES6 ä¸­ä¸å¯æšä¸¾

```javascript
// []
console.log(Object.keys(Es6Person.prototype));
// ["getAge"]
console.log(Object.keys(Es5Person.prototype));
```

åœ¨ ES5 ä¸­å¦‚æœä¸ç”¨ newï¼Œthis æŒ‡å‘ windows å…¨å±€å˜é‡ï¼Œåœ¨ ES6 å¦‚æœä¸ç”¨ new å…³é”®å­—åˆ™ä¼šæŠ¥é”™å¤„ç†

```javascript
// Uncaught TypeError: Class constructor Person cannot be invoked without 'new'
let person2 = Es6Person('ziyi2', 111);
```

ES6 ä¸­çš„ç±»æ˜¯ä¸ä¼šå£°æ˜æå‡çš„, ES5 å¯ä»¥

```javascript
// Es5PersonÂ {}
console.log(Es5Person)
// Uncaught ReferenceError: Es6Person is not defined
let es6 = new Es6Person()
console.log(es6)

class Es6Person {}
function Es5Person {}
```

åœ¨ ES6 ä¸­å¦‚æœä¸å†™æ„é€ æ–¹æ³•

```javascript
class Es6Person {}

// ç­‰åŒäº
class Es6Person {
  constructor() {}
}
```

åœ¨ ES6 ä¸­ç±»çš„å±æ€§åå¯ä»¥é‡‡ç”¨è¡¨è¾¾å¼

```javascript
const getAge = Symbol('getAge');

class Es6Person {
  constructor(name, age) {
    this.name = name;
    this.age = age;
    this.getName = () => {
      return this.name;
    };
  }

  // è¡¨è¾¾å¼
  [getAge]() {
    return this.age;
  }
}

let es6Person = new Es6Person('ziyi2', 28);
es6Person[getAge]();
```

#### ç±»çš„ç§æœ‰æ–¹æ³•å’Œç§æœ‰å±æ€§

åœ¨ ES6 çš„ç±»ä¸­ç›®å‰å¹¶æ²¡æœ‰ç§æœ‰æ–¹æ³•å’Œç§æœ‰å±æ€§çš„æ ‡å‡†è¯­æ³•ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡å…¶ä»–æ–¹å¼æ¨¡æ‹Ÿå®ç°ï¼Œä¾‹å¦‚å±æ€§åé‡‡ç”¨è¡¨è¾¾å¼ï¼Œè€Œ ES5 ä¸­å¾ˆéš¾å®ç°

```javascript
// åˆ©ç”¨Symbolå€¼çš„å”¯ä¸€æ€§
const getAge = Symbol('getAge');
const job = Symbol('job');

class Es6Person {
  constructor(name, age) {
    this.name = name;
    this.age = age;
    this.getName = () => {
      return this.name;
    };
    // ç§æœ‰å±æ€§
    this[job] = 'web';
  }

  // ç§æœ‰æ–¹æ³•
  [getAge]() {
    return this.age;
  }
}

let es6Person = new Es6Person('ziyi2', 28);
es6Person[getAge]();
es6Person[job];
```

> æ­¤æ—¶å¦‚æœ Es6Person ç±»å¤„åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œé‚£ä¹ˆ getAge å’Œ job å˜é‡æ˜¯å½“å‰æ–‡ä»¶çš„å±€éƒ¨å˜é‡ï¼Œå¤–éƒ¨æ–‡ä»¶æ— æ³•è®¿é—®ï¼Œä»è€Œåœ¨å¤–éƒ¨æ–‡ä»¶è°ƒç”¨ Es6Person ç±»çš„æ—¶å€™æ— æ³•è®¿é—®å…·æœ‰å”¯ä¸€æ€§çš„ getAge å’Œ job å˜é‡ï¼Œä»è€Œä½¿ä¹‹æˆä¸ºç§æœ‰æ–¹æ³•å’Œç§æœ‰å±æ€§ã€‚ç›®å‰ç§æœ‰å±æ€§æœ‰ä¸€ä¸ª 3 é˜¶æ®µçš„[ææ¡ˆ](https://github.com/tc39/proposal-private-methods)ã€‚

#### ç±»çš„ getter å’Œ setter

ES6 åˆ©ç”¨ get å’Œ set å…³é”®å­—å¯¹æŸå±æ€§è®¾ç½®å­˜å€¼å‡½æ•°å’Œå–å€¼å‡½æ•°æ‹¦æˆªå±æ€§çš„å­˜å–è¡Œä¸ºå’Œ ES5 ä¸€æ ·ã€‚

```javascript
class Es6Person {
  constructor(name, age) {
    this.name = name;
    this.age = age;
  }

  get name() {
    return 'ziyi2';
  }

  set name(value) {
    console.log('setter: ', value);
  }
}

// setter: ziyi3
let person = new Es6Person('ziyi3', 11);
// ziyi2
console.log(person.name);
// setter: ziyi2
person.name = 'ziyi2';
```

#### ç±»çš„ Generator æ–¹æ³•

ç»™ç±»å¢åŠ ä¸€ä¸ªéå†å™¨ï¼Œä»è€Œä½¿ç±»å¯ä»¥è¿›è¡Œ for...of æ“ä½œ

```javascript
class Es6Person {
  constructor(...args) {
    this.args = args;
  }

  *[Symbol.iterator]() {
    for (let arg of this.args) {
      yield arg;
    }
  }
}

let person = new Es6Person('ziyi3', 11);

for (let value of person) {
  // ziyi3
  // 11
  console.log(value);
}
```

#### ç±»çš„é™æ€æ–¹æ³•

```javascript
class Es6Person {
  // ç±»çš„é™æ€æ–¹æ³•
  static getClassName() {
    // thisæŒ‡å‘ç±»ï¼Œè€Œä¸æ˜¯å®ä¾‹å¯¹è±¡
    return 'Es6Person';
  }

  // ç±»çš„é™æ€æ–¹æ³•
  static getName() {
    // thisæŒ‡å‘ç±»ï¼Œè€Œä¸æ˜¯å®ä¾‹å¯¹è±¡
    return this.getClassName();
  }
}

// Es6Person
console.log(Es6Person.getName());
```

#### ç±»çš„é™æ€å±æ€§ææ¡ˆ

ES6 æ˜ç¡®è§„å®šï¼ŒClass å†…éƒ¨åªæœ‰é™æ€æ–¹æ³•ï¼Œæ²¡æœ‰é™æ€å±æ€§ï¼Œç›®å‰æœ‰ä¸€ä¸ªé™æ€å±æ€§çš„ææ¡ˆï¼Œå¯¹é™æ€å±æ€§è§„å®šäº†æ–°çš„å†™æ³•

```javascript
class Es6Person {
  static className = 'Es6Person';
}
```

#### new.target

new.target è¿”å› new å‘½ä»¤ä½œç”¨äºçš„é‚£ä¸ªæ„é€ å‡½æ•°

```javascript
class Es6Person {
  constructor(name) {
    // new.target = class Es6Person {}
    if (new.target === Es6Person) {
      this.name = name;
    } else {
      throw new Error('æ²¡æœ‰ç”¨newå‘½ä»¤ç”Ÿæˆå®ä¾‹å¯¹è±¡');
    }
  }
}
let person = new Es6Person('ziyi2');
```

> new.target å¯ä»¥ç”¨äºæŒ‡å®šå“ªäº›å­ç±»å¯ä»¥ç»§æ‰¿çˆ¶ç±»ã€‚

#### ç±»çš„ç»§æ‰¿

ES5 çš„ç»§æ‰¿ä½¿ç”¨å€ŸåŠ©æ„é€ å‡½æ•°å®ç°ï¼Œå®è´¨æ˜¯å…ˆåˆ›é€ å­ç±»çš„å®ä¾‹å¯¹è±¡ thisï¼Œç„¶åå†å°†çˆ¶ç±»çš„æ–¹æ³•æ·»åŠ åˆ° this ä¸Šé¢ã€‚ES6 çš„ç»§æ‰¿æœºåˆ¶å®Œå…¨ä¸åŒï¼Œå®è´¨æ˜¯å…ˆåˆ›é€ çˆ¶ç±»çš„å®ä¾‹å¯¹è±¡ thisï¼ˆæ‰€ä»¥å¿…é¡»å…ˆè°ƒç”¨ super æ–¹æ³•ï¼‰ï¼Œç„¶åå†ç”¨å­ç±»çš„æ„é€ å‡½æ•°ä¿®æ”¹ thisã€‚

å­ç±»å¿…é¡»åœ¨ constructor æ–¹æ³•ä¸­è°ƒç”¨ super æ–¹æ³•ï¼Œå¦åˆ™æ–°å»ºå®ä¾‹æ—¶ä¼šæŠ¥é”™ã€‚è¿™æ˜¯å› ä¸ºå­ç±»è‡ªå·±çš„ this å¯¹è±¡ï¼Œå¿…é¡»å…ˆé€šè¿‡çˆ¶ç±»çš„æ„é€ å‡½æ•°å®Œæˆå¡‘é€ ï¼Œå¾—åˆ°ä¸çˆ¶ç±»åŒæ ·çš„å®ä¾‹å±æ€§å’Œæ–¹æ³•ï¼Œç„¶åå†å¯¹å…¶è¿›è¡ŒåŠ å·¥ï¼ŒåŠ ä¸Šå­ç±»è‡ªå·±çš„å®ä¾‹å±æ€§å’Œæ–¹æ³•ã€‚å¦‚æœä¸è°ƒç”¨ super æ–¹æ³•ï¼Œå­ç±»å°±å¾—ä¸åˆ° this å¯¹è±¡

```javascript
class Es6Person {
  constructor(name) {
    this.name = name;
  }
}

class Es6WebDeveloper extends Es6Person {
  constructor(name, age) {
    // è¡¨ç¤ºçˆ¶ç±»æ„é€ å‡½æ•°
    // å­ç±»å®ä¾‹çš„æ„å»ºï¼Œæ˜¯åŸºäºå¯¹çˆ¶ç±»å®ä¾‹åŠ å·¥ï¼Œåªæœ‰superæ–¹æ³•æ‰èƒ½è¿”å›çˆ¶ç±»å®ä¾‹
    super(name);
    this.age = age;
  }
}
```

ä¾‹å¦‚ä»¥ä¸‹å†™æ³•ä¼šæŠ¥é”™

```javascript
class Es6Person {
  constructor(name) {
    this.name = name;
  }
}

class Es6WebDeveloper extends Es6Person {
  constructor(name, age) {
    // Uncaught ReferenceError: Must call super constructor in derived class before accessing 'this' or returning from derived constructor
    console.log(this);
    super(name);
  }
}

let developer = new Es6WebDeveloper('ziyi2', 11);
```

æ­¤æ—¶çš„ç»§æ‰¿ç±»ä¼¼äº ES5 çš„å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿ï¼Œå­ç±»çš„åŸå‹å¯¹è±¡ä¸­æ²¡æœ‰çˆ¶ç±»çš„å®ä¾‹å¯¹è±¡å’Œå®ä¾‹æ–¹æ³•

```javascript
// Es6PersonÂ {constructor: Æ’}
console.log(Es6WebDeveloper.prototype);
```

ES6 åœ¨ç»§æ‰¿çš„è¯­æ³•ä¸Šæ˜¾ç„¶ä¹Ÿè€ƒè™‘çš„æ›´åŠ å‘¨åˆ°ï¼Œä¸ä»…ç»§æ‰¿äº†ç±»çš„åŸå‹å¯¹è±¡ï¼Œè¿˜ç»§æ‰¿äº†ç±»çš„é™æ€å±æ€§å’Œé™æ€æ–¹æ³•

```javascript
class Es6Person {
  static getClassName() {
    return Es6Person.name;
  }

  constructor(name) {
    this.name = name;
  }
}

class Es6WebDeveloper extends Es6Person {
  constructor(name, age) {
    super(name);
    this.age = age;
  }
}

// Es6Person
Es6WebDeveloper.getClassName();
```

#### super å…³é”®å­—

super ä½œä¸ºå‡½æ•°è°ƒç”¨æ—¶ï¼Œä»£è¡¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œåªèƒ½åœ¨å­ç±»çš„æ„é€ å‡½æ•°ä¸­ä½¿ç”¨

```javascript
class Es6Person {
  constructor(name) {
    // Es6WebDeveloper
    console.log(new.target.name);
    // Es6WebDeveloperÂ {}
    console.log(this);
    this.name = name;
  }
}

class Es6WebDeveloper extends Es6Person {
  constructor(name, age) {
    // ç±»ä¼¼äºA.prototype.constructor.call(this)
    // superå†…éƒ¨çš„thisæŒ‡å‘Es6WebDeveloper
    super(name);
    this.age = age;
  }
}

let developer = new Es6WebDeveloper('ziyi2');
```

é™¤æ­¤ä¹‹å¤–ï¼Œsuper å½“åšä¸€ä¸ªå¯¹è±¡ä½¿ç”¨ï¼Œåœ¨å­ç±»æ™®é€šæ–¹æ³•ï¼ˆåŸå‹å¯¹è±¡ï¼‰ä¸­ï¼ŒæŒ‡å‘çˆ¶ç±»çš„åŸå‹å¯¹è±¡ï¼Œå› æ­¤å¯ä»¥è°ƒç”¨çˆ¶ç±»çš„åŸå‹æ–¹æ³•ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯æ‰§è¡Œçˆ¶ç±»çš„åŸå‹æ–¹æ³•æ—¶ï¼Œåœ¨æ–¹æ³•ä¸­æ‰§è¡Œæ—¶ this æŒ‡å‘çš„æ˜¯å­ç±»çš„å®ä¾‹å¯¹è±¡è€Œä¸æ˜¯çˆ¶ç±»çš„å®ä¾‹å¯¹è±¡

```javascript
class Es6Person {
  constructor(name) {
    this.name = name;
  }
  getName() {
    // Es6WebDeveloperÂ {name: "ziyi2", age: undefined}
    // å­ç±»çš„whoIsSuperä¸­è°ƒç”¨çš„super.getNameåœ¨è¿™é‡Œæ‰§è¡Œçš„thisæŒ‡å‘å­ç±»å®ä¾‹å¯¹è±¡
    console.log(this);
    return this.name;
  }
}

Es6Person.prototype.className = Es6Person.name;

class Es6WebDeveloper extends Es6Person {
  constructor(name, age) {
    super(name);
    this.age = age;
  }
  whoIsSuper() {
    // true
    console.log(super.getName === Es6Person.prototype.getName);

    // superæ— æ³•è·å–çˆ¶ç±»çš„å®ä¾‹å±æ€§
    // å› ä¸ºsuperæŒ‡å‘çš„æ˜¯çˆ¶ç±»çš„åŸå‹å¯¹è±¡

    // undefined
    console.log(super.name);
    // Es6Person
    console.log(super.className);

    return super.getName();
  }
}

let developer = new Es6WebDeveloper('ziyi2');
// ziyi2
console.log(developer.whoIsSuper());
```

å¦‚æœ super ç”¨ä½œå¯¹è±¡ä¸”ä¸åœ¨å­ç±»çš„åŸå‹å¯¹è±¡ä¸­è°ƒç”¨ï¼Œè€Œæ˜¯åœ¨å­ç±»çš„é™æ€æ–¹æ³•ä¸­è°ƒç”¨ï¼Œé‚£ä¹ˆ super æŒ‡ä»£çˆ¶ç±»è€Œä¸æ˜¯çˆ¶ç±»çš„åŸå‹å¯¹è±¡ï¼ŒåŒç†è°ƒç”¨çˆ¶ç±»é™æ€æ–¹æ³•æ—¶ this æŒ‡å‘å­ç±»è€Œä¸æ˜¯çˆ¶ç±»

```javascript
class Es6Person {
  static getClassName() {
    // class Es6WebDeveloper extends Es6Person {
    // ...
    // åœ¨å­ç±»ä¸­ä½¿ç”¨superè°ƒç”¨æ—¶ï¼ŒthisæŒ‡å‘å­ç±»
    console.log(this);
    return this.name;
  }

  constructor(name) {
    this.name = name;
  }
}

class Es6WebDeveloper extends Es6Person {
  constructor(name, age) {
    super(name);
    this.age = age;
  }

  static getClassName() {
    return super.getClassName();
  }
}

// Es6WebDeveloper
console.log(Es6WebDeveloper.getClassName());
```

#### ES6 çš„ç»§æ‰¿åŸç†

**proto**å­˜åœ¨äºå®ä¾‹ä¸æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ä¹‹é—´

```javascript
class Es6Person {
  constructor(name) {
    this.name = name;
  }
}

let es6Person = new Es6Person('ziyi2');
// true
console.log(es6Person.__proto__ === Es6Person.prototype);
```

ES6 çš„ç»§æ‰¿åŸç†

```javascript
class Es6Person {}
class Es6WebDeveloper extends Es6Person {}

// true
// Es6WebDeveloperçœ‹åšä¸€ä¸ªå®ä¾‹å¯¹è±¡
// Es6Personçœ‹åšä¸€ä¸ªåŸå‹å¯¹è±¡
// å› æ­¤Es6WebDeveloperç»§æ‰¿äº†Es6Personçš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•
// å®ç°äº†ç±»çš„é™æ€å±æ€§å’Œæ–¹æ³•çš„ç»§æ‰¿
// å­ç±»çš„åŸå‹æ˜¯çˆ¶ç±»
console.log(Es6WebDeveloper.__proto__ === Es6Person);

// true
// è¿™é‡Œç±»ä¼¼äº Es6WebDeveloper.prototype = new Es6Person()
// å’ŒES5çš„åŸå‹é“¾ä¸€æ ·
// å­ç±»çš„åŸå‹å¯¹è±¡æ˜¯çˆ¶ç±»çš„åŸå‹å¯¹è±¡çš„å®ä¾‹
// å­ç±»çš„å®ä¾‹ç»§æ‰¿çˆ¶ç±»çš„å®ä¾‹
console.log(Es6WebDeveloper.prototype.__proto__ === Es6Person.prototype);
```

å› æ­¤ä»¥ä¸‹ç»§æ‰¿éƒ½æ˜¯å¯ç†è§£çš„

```javascript
class A extends Object {}

A.__proto__ === Object; // true
A.prototype.__proto__ === Object.prototype; // true

class A {}

A.__proto__ === Function.prototype; // true
A.prototype.__proto__ === Object.prototype; // true
```
