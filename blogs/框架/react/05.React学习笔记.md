---
title: React å­¦ä¹ ç¬”è®°
date: 2021-06-05 00:00:00
sidebar: auto
sticky: false
permalink: /pages/react210605/
categories: 
  - æ¡†æ¶
tags: 
  - react
---
<p align="center">
  <img width="500" src="https://p15.qhimg.com/dmfd/2560_1440_/t01bc6918e95330e098.jpg"/>
</p>

> React åŸºç¡€æ€»ç»“

<!-- more -->

## åŸºç¡€

#### æ¡†æ¶å®šä¹‰

æ˜¯ä¸€ä¸ªå°†æ•°æ®æ¸²æŸ“ä¸ºHTMLè§†å›¾çš„å¼€æº javascript åº“

- reactç‰¹ç‚¹

  - ç»„ä»¶åŒ–ã€å£°æ˜å¼ç¼–ç ï¼Œæé«˜å¼€å‘æ•ˆç‡
  - è™šæ‹ŸDOM + ä¼˜ç§€Diffingç®—æ³•
  - åœ¨React Nativeä¸­ä½¿ç”¨Reactè¯­æ³•è¿›è¡Œç§»åŠ¨ç«¯å¼€å‘
- è™šæ‹ŸDOM

  - æœ¬è´¨æ˜¯Objectç±»å‹çš„å¯¹è±¡
  - **è™šæ‹ŸDOMæ¯”è¾ƒâ€œè½»â€ï¼ŒçœŸå®DOMæ¯”è¾ƒé‡**ï¼Œå› ä¸ºè™šæ‹ŸDOMæ˜¯Reactå†…éƒ¨åœ¨ç”¨ï¼Œä¸éœ€çœŸå®DOMä¸Šé‚£ä¹ˆå¤šçš„å±æ€§
  - è™šæ‹ŸDOMæœ€ç»ˆä¼šè¢«è½¬åŒ–ä¸ºçœŸå®DOMï¼Œå‘ˆç°åœ¨é¡µé¢
- jsxè¯­æ³•è§„åˆ™

  - å®šä¹‰è™šæ‹ŸDOMæ—¶ï¼Œä¸è¦å†™å¼•å·
  - æ··å…¥jsè¡¨è¾¾å¼è¦ç”¨{}
  - ç±»å className
  - å†…è”æ ·å¼
  - åªæœ‰ä¸€ä¸ªæ ¹æ ‡ç­¾
  - æ ‡ç­¾å¿…é¡»é—­åˆ
  - æ ‡ç­¾é¦–å­—æ¯
    - å°å†™ï¼ˆæ‰¾å¯¹åº”htmlä¸­åŒåå…ƒç´ ï¼‰
    - å¤§å†™ï¼ˆæ‰¾å¯¹åº”ç»„ä»¶ï¼‰
- jsxèƒŒæ™¯
  1. å…¨ç§°: javaScript XML
  2. reactå®šä¹‰çš„ä¸€ç§ç±»ä¼¼äºXMLçš„JSæ‰©å±•è¯­æ³•ï¼š JS + XML
  3. æœ¬è´¨æ˜¯React.creteElement( component, props, ...children ) æ–¹æ³•çš„è¯­æ³•ç³–
  4. ç”¨æ¥ç®€åŒ–åˆ›å»ºè™šæ‹ŸDOM
     - ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œä¹Ÿä¸æ˜¯HTML/XMLæ ‡ç­¾
     - æœ€ç»ˆäº§ç”Ÿçš„å°±æ˜¯ä¸€ä¸ªJSå¯¹è±¡

#### å‡†å¤‡å·¥ä½œ

```javascript
<body>
    <script type="text/javascript" src="js/react.development.js"></script> // å¼•å…¥React
    <script type="text/javascript" src="js/react-dom.development.js"></script> // å¼•å…¥ReactDOM
    <script type="text/javascript" src="js/babel.min.js"></script> // å¼•å…¥babel,å°†jsxè½¬ä¸ºjs
    <script type="text/javascript" src="js/prop-types.js"></script> // å¼•å…¥prop-types,ç”¨äºå¯¹ç»„ä»¶æ ‡ç­¾ prop è¿›è¡Œé™åˆ¶
</body>  
```

#### è¡¨è¾¾å¼ `vs`è¯­å¥

```javascript
/*
        ä¸€å®šæ³¨æ„åŒºåˆ†ï¼šã€jsè¯­å¥(ä»£ç )ã€‘ä¸ã€jsè¡¨è¾¾å¼ã€‘
                1.è¡¨è¾¾å¼ï¼šä¸€ä¸ªè¡¨è¾¾å¼ä¼šäº§ç”Ÿä¸€ä¸ªå€¼ï¼Œå¯ä»¥æ”¾åœ¨ä»»ä½•ä¸€ä¸ªéœ€è¦å€¼çš„åœ°æ–¹
                            ä¸‹é¢è¿™äº›éƒ½æ˜¯è¡¨è¾¾å¼ï¼š
                                    (1). a
                                    (2). a+b
                                    (3). demo(1)
                                    (4). arr.map()
                                    (5). function test () {}
                2.è¯­å¥(ä»£ç )ï¼š
                            ä¸‹é¢è¿™äº›éƒ½æ˜¯è¯­å¥(ä»£ç )ï¼š
                                    (1).if(){}
                                    (2).for(){}
                                    (3).switch(){case:xxxx}

 */
```

#### å”¯ä¸€keyå€¼

> å› ä¸º `{}`è¦å†™è¡¨è¾¾å¼ï¼Œæ‰€ä»¥è¦ä½¿ç”¨`arr.map`éå†

#### åˆ›å»ºå‡½æ•°å¼ç»„ä»¶

```javascript
<script type="text/babel">
    function MyComponent() {
    	return <h2>è‡ªå®šä¹‰ç»„ä»¶</h2>
	}
	ReactDom.reader(<MyComponent/>, document.getElementById('test'))
</script>    
```

#### åˆ›å»ºç±»å¼ç»„ä»¶

```javascript
<script type="text/babel">
    class MyComponent extends React.Component {
        render() {
            return <h2>è‡ªå®šä¹‰ç»„ä»¶</h2>
        }
    }
	ReactDom.render(<MyComponent/>, document.getElementById('test'))
</script>   
```

#### ç»„ä»¶å®ä¾‹æ ¸å¿ƒå±æ€§State

```javascript
<script type="text/babel">
    class Weather extends React.Component {
        constructor(props) {
            super(props)
            this.state = { isHot: false, wind: 'å¾®é£' }  // ç¬¬ä¸€å°è±¡ï¼Œå¯ä¼˜åŒ–
            this.changeWeather = this.changeWeather.bind(this) // æ”¹å˜åŸå‹æ–¹æ³•ä¸ŠthisæŒ‡å‘åŒæ—¶èµ‹å€¼ç»™this.changeWeatheræ–¹æ³•ï¼Œå¯ä¼˜åŒ–
        }
        render() {
            const { isHot, wind } = this.state
            return <h1 onClick={this.changeWeather}>ä»Šå¤©å¤©æ°”å¾ˆ{ isHot ? 'ç‚çƒ­' : 'å‡‰çˆ½' }, { wind }<h1/>
        }
        changeWeather() {
            const isHot = this.state.isHot
            this.setState({ isHot: !isHot })  // æ­£ç¡®å†™æ³•
            // this.state.isHot = !isHot //é”™è¯¯å†™æ³•
        }    
    }
    ReactDOM.render(<Weather/>, document.getElementById('test'))    
</script>  
```

#### ä¸¤ä¸ªå°æŠ€å·§

```javascript
<script type="text/javascript" >
    // ç±»ä¸­å¯ä»¥ç›´æ¥å†™èµ‹å€¼è¯­å¥ï¼Œå¦‚ä¸‹ä»£ç å«ä¹‰ï¼š ç»™carçš„å®ä¾‹å¯¹è±¡æ·»åŠ ä¸€ä¸ªå±æ€§ï¼Œåä¸ºa, å€¼ä¸º1
    // è‡ªå®šä¹‰æ–¹æ³•â€”â€”è¦ç”¨èµ‹å€¼è¯­å¥çš„å½¢å¼ + ç®­å¤´å‡½æ•°ï¼Œæ•…æ­¤å¯¼è‡´thisæŒ‡å‘ç±»
    class Car {
        constructor(name, price) {
            this.name = name
            this.price = price
            // this.wheel = 4
        }
        a = 1
        wheel = 4
        static demo = 100
    }
</script>    
```



#### stateç®€å†™æ ¼å¼

```javascript
<script type="text/babel">
	// åˆ›å»ºç»„ä»¶
    class Weather extends React.Component {
        state = { isHot: false, wind: 'å¾®é£' } // ä¼˜åŒ–ä¸€
        render() {
            const { isHot, wind } = this.state
            return <h1 onClick={ this.changeWeather }>ä»Šå¤©å¤©æ°”å¾ˆ{isHot ? 'ç‚çƒ­' : 'å‡‰çˆ½'}, { wind }</h1>
        }
        // è‡ªå®šä¹‰æ–¹æ³•â€”â€”è¦ç”¨èµ‹å€¼è¯­å¥çš„å½¢å¼ + ç®­å¤´å‡½æ•°
        changeWeather = () => { // ä¼˜åŒ–äºŒ
            const isHot = this.state.isHot
            this.setState({ isHot: !isHot })
        }
    }
	// æ¸²æŸ“ç»„ä»¶åˆ°é¡µé¢
	ReactDOM.render(<weather/>, document.getElementById('test'))
</script>  
```

#### propsåŸºæœ¬ä½¿ç”¨

```javascript
<script type="text/babel">
	// åˆ›å»ºç»„ä»¶
    class Person extends React.Component {
        render() {
            const { name, age, sex } = this.props
            return (
            	<ul>
                	<li>å§“åï¼š{ name }</li>
                	<li>æ€§åˆ«ï¼š{ sex }</li>
                	<li>å¹´é¾„ï¼š{ age + 1 }</li>
                </ul>
            )
        }
    }
    // æ¸²æŸ“ç»„ä»¶åˆ°é¡µé¢
    ReactDom.render(<Person name="jerry" age={19} sex="ç”·"/>, document.getElementById(test1))
    ReactDom.render(<Person name="tom" age={18} sex="å¥³"/>, document.getElementById(test2))
    const p = {name: 'è€åˆ˜', age: 18, sex: 'å¥³'}
    // ReactDom.render(<Person name={p.name} age={p.age} sex={p.sex}/>, document.getElementById(test3))
    ReactDom.render(<Person {...p}/>, document.getElementById('test3'))
</script>   
```

#### å±•å¼€è¿ç®—ç¬¦...ç»ƒä¹ 

- å±•å¼€è¿ç®—ç¬¦ä¸èƒ½å±•å¼€å¯¹è±¡ï¼ŒæŠ¥é”™

- `{...person} `  ä¸ºæµ…æ‹·è´æ“ä½œ

- åˆå¹¶ä¿®æ”¹

  ```javascript
  let person = { name: 'tom', age: 12 }
  let person2 = {...person, name: 'jack', address: 'åœ°çƒ'}
  ```

#### propsç±»å‹é™åˆ¶  

```javascript
<script type="text/babel">
    // åˆ›å»ºç»„ä»¶
    class Person extends React.Component{
        render() {
            const { name, age, sex } = this.props // propsåªè¯»
            return (
            	<ul>
                	<li>å§“åï¼š{ name }</li>
                	<li>æ€§åˆ«ï¼š{ sex }</li>
                	<li>å¹´é¾„ï¼š{ age + 1 }</li>
                </ul>
            )
        }
    }
    Person.propTypes = {
        name: PropTypes.string.isRequired, //é™åˆ¶nameå¿…ä¼ ï¼Œä¸”ä¸ºå­—ç¬¦ä¸²
        sex: PropTypes,string, // é™åˆ¶sexä¸ºå­—ç¬¦ä¸²
        age: PropTypes.number, // é™åˆ¶ageä¸ºæ•°å€¼
        speak: PropTypes.func // é™åˆ¶speakä¸ºå‡½æ•°ï¼Œå› ä¸ºfunctionä¸ºå…³é”®å­—ï¼Œæ‰€ä»¥æ›´æ”¹ä¸ºfunc
    }
	Person.defaultProps = {
        sex: 'ç”·', // sexé»˜è®¤å€¼ä¸ºç”·
        age: 18 // ageé»˜è®¤å€¼ä¸º18
    }
	// æ¸²æŸ“ç»„ä»¶åˆ°é¡µé¢
    ReactDom.render(<Person name="jerry" age={19} sex="ç”·"/>, document.getElementById(test1))
    ReactDom.render(<Person name="tom" age={18} sex="å¥³"/>, document.getElementById(test2))
    const p = {name: 'è€åˆ˜', age: 18, sex: 'å¥³'}
    // ReactDom.render(<Person name={p.name} age={p.age} sex={p.sex}/>, document.getElementById(test3))
    ReactDom.render(<Person {...p}/>, document.getElementById('test3'))
</script>   
```

#### propsç®€å†™å½¢å¼

```javascript
<script type="text/babel">
    // åˆ›å»ºç»„ä»¶
    class Person extends React.Component {
        constructor(props) {
            super(props) // æ„é€ å™¨æ˜¯å¦æ¥æ”¶props,æ˜¯å¦ä¼ é€’ç»™super, å–å†³äºï¼š æ˜¯å¦å¸Œæœ›åœ¨æ„é€ å™¨ä¸­é€šè¿‡thisè®¿é—®props
        }
        static propTypes = {
            name: PropTypes.string.isRequired,
            sex: PropTypes.string,
            age: PropTypes.number
        }
        static defaultProps = {
            sex: 'ç”·',
            age: 18
        }
        render() {
            const { name, age, sex } = this.props // propsåªè¯»
            return (
            	<ul>
                	<li>å§“åï¼š{ name }</li>
                	<li>æ€§åˆ«ï¼š{ sex }</li>
                	<li>å¹´é¾„ï¼š{ age + 1 }</li>
                </ul>
            )
        }
    }
    // æ¸²æŸ“çµ„ä»¶åˆ°é é¢
    ReactDOM.render(<Person name="jerry"/>, document.getElementById('test'))
</script>   
```

#### å‡½æ•°å¼ç»„ä»¶ä½¿ç”¨props

```javascript
<script type="text/babel">
    // åˆ›å»ºç»„ä»¶
    function Person(props) {
    	const { name, age, sex } = props
        return (
            <ul>
                <li>å§“åï¼š{ name }</li>
                <li>æ€§åˆ«ï¼š{ sex }</li>
                <li>å¹´é¾„ï¼š{ age + 1 }</li>
            </ul>
        )
	}
    Person.propTypes = {
        name: PropTypes.string.isRequired,
        sex: PropTypes.string,
        age: PropTypes.number
    }
	Person.defaultProps = {
        sex: 'ç”·'ï¼Œ
        age: 18
    }
	// æ¸²æŸ“çµ„ä»¶åˆ°é é¢
    ReactDOM.render(<Person name="jerry"/>, document.getElementById('test'))
</script>   
```

#### å­—ç¬¦ä¸²å½¢å¼çš„refs

```javascript
<script type="text/babel">
    // åˆ›å»ºç»„ä»¶
    class Demo extends React.Component {
        showData = () => {
            const { input1 } = this.refs
        }
    }
	render() {
        return (
        	<input ref="input1" type="text" placeholder="ç‚¹å‡»æŒ‰é’®æç¤ºæ•°æ®"/>
        )
    }
	// æ¸²æŸ“ç»„ä»¶
	ReactDOM.render(<Demo a="1" b="2"/>, document.getElementById('test'))
</script>   
```

#### å›è°ƒå‡½æ•°å½¢å¼çš„refs

```javascript
<script type="text/babel">
    // åˆ›å»ºç»„ä»¶
    class Demo extends React.Component {
        showData = () => {
            const { input1 } = this
        }
    }
	render() {
        return (
        	<input ref="{ c => this.input1 = c }" type="text" placeholder="ç‚¹å‡»æŒ‰é’®æç¤ºæ•°æ®"/>
        )
    }
	// æ¸²æŸ“ç»„ä»¶
	ReactDOM.render(<Demo a="1" b="2"/>, document.getElementById('test'))
</script>   
```

#### å›è°ƒå‡½æ•°refsçš„è¯´æ˜

> å¦‚æœrefå›è°ƒå‡½æ•°æ˜¯ä»¥å†…è”å‡½æ•°æ–¹å¼å®šä¹‰çš„ï¼Œåœ¨æ›´æ–°è¿‡ç¨‹ä¸­ä¼šè¢«æ‰§è¡Œ**ä¸¤æ¬¡**ï¼Œç¬¬ä¸€å‚æ•°ä¸ºnullï¼Œç¬¬äºŒæ¬¡ä¼šä¼ å…¥å‚æ•°DOMå…ƒç´ ï¼ˆå½“å‰èŠ‚ç‚¹ï¼‰

> è§£å†³ï¼š é€šè¿‡refçš„å›è°ƒå‡½æ•°å®šä¹‰æˆcalssçš„ç»‘å®šå‡½æ•°çš„æ–¹å¼å¯ä»¥é¿å…

> å®ƒæ˜¯æ— å…³ç´§è¦çš„

#### createRefçš„ä½¿ç”¨

```javascript
<script type="text/babel">
    // åˆ›å»ºç»„ä»¶
    class Demo extends React.Component {
        showData = () => {
            const { input1 } = this
        }
    }
	// React.createRefè°ƒç”¨åå¯ä»¥è¿”å›ä¸€ä¸ªå®¹å™¨ï¼Œè¯¥å®¹å™¨å¯ä»¥å­˜å‚¨refæ‰€æ ‡è¯†çš„èŠ‚ç‚¹ï¼Œè¯¥å®¹å™¨æ˜¯â€œä¸“äººä¸“ç”¨â€
	myRef = React.createRef()
	render() {
        return (
            <div>
            	<input ref={this.myRef} type="text" placeholder="ç‚¹å‡»æŒ‰é’®æç¤ºæ•°æ®"/>
            <div/>
        )
    }
	// æ¸²æŸ“ç»„ä»¶
	ReactDOM.render(<Demo a="1" b="2"/>, document.getElementById('test'))
</script> 
```

#### äº‹ä»¶å¤„ç†

- é€šè¿‡onXxxå±æ€§æŒ‡å®šäº‹ä»¶å¤„ç†å‡½æ•°ï¼ˆæ³¨æ„å¤§å°å†™ï¼‰
  - Reactä½¿ç”¨çš„æ˜¯è‡ªå®šä¹‰ï¼ˆåˆæˆï¼‰äº‹ä»¶ï¼Œè€Œä¸æ˜¯ä½¿ç”¨åŸç”ŸDOMäº‹ä»¶ â€”â€”ä¸ºäº†æ›´å¥½çš„å…¼å®¹æ€§
  - Reactä¸­çš„äº‹ä»¶æ˜¯é€šè¿‡äº‹ä»¶å§”æ‰˜æ–¹å¼å¤„ç†çš„ï¼ˆå§”æ‰˜ç»„ä»¶æœ€å¤–å±‚çš„å…ƒç´ ï¼‰â€”â€”ä¸ºäº†é«˜æ•ˆ
- é€šè¿‡`event.targer`å¾—åˆ°å‘ç”Ÿäº‹ä»¶çš„DOMå…ƒç´ å¯¹è±¡â€”â€”ä¸è¦è¿‡åº¦ä½¿ç”¨ref

```javascript
<script type="text/babel">
    //åˆ›å»ºç»„ä»¶
    class Demo extends React.Component{
        //åˆ›å»ºrefå®¹å™¨
        myRef = React.createRef()
        myRef2 = React.createRef()

        //å±•ç¤ºå·¦ä¾§è¾“å…¥æ¡†çš„æ•°æ®ï¼Œå› ä¸ºè·å–çš„ä¸æ˜¯æœ¬èº«ä¸Šçš„å±æ€§ï¼Œæ‰€æœ‰éœ€å€ŸåŠ©refå®ç°
        showData = (event)=>{
            console.log(event.target);
            alert(this.myRef.current.value);
        }

        //å±•ç¤ºå³ä¾§è¾“å…¥æ¡†çš„æ•°æ®, å¯ä»¥ä¸ä½¿ç”¨ref
        showData2 = (event)=>{
            alert(event.target.value);
        }

        render(){
            return(
                <div>
                    <input ref={this.myRef} type="text" placeholder="ç‚¹å‡»æŒ‰é’®æç¤ºæ•°æ®"/>&nbsp;
                    <button onClick={this.showData}>ç‚¹æˆ‘æç¤ºå·¦ä¾§çš„æ•°æ®</button>&nbsp;
            		<input onBlur={this.showData2} type="text" placeholder="å¤±å»ç„¦ç‚¹æç¤ºæ•°æ®"/>&nbsp;
            	</div>
			)
		}
    }
    //æ¸²æŸ“ç»„ä»¶åˆ°é¡µé¢
    ReactDOM.render(<Demo a="1" b="2"/>,document.getElementById('test'))
</script>
```

#### éå—æ§ç»„ä»¶ï¼ˆç›¸å½“äºvueä¸­çš„ v-bindï¼‰

```javascript
<script type="text/babel">
	//åˆ›å»ºç»„ä»¶
	class Login extends React.Component{
        render() {
            return (
            	<form onSubmit={this.handleSubmit}>
                	ç”¨æˆ·åï¼š<input ref={ c => this.username = c } type="text" name="username"/>
                    å¯†ç ï¼š<input ref={ c => this.password = c } type="password" name="password"/>   
                <from/>
            )
        }
        handleSubmit = (event) => {
            event.preventDefault() //é˜»æ­¢è¡¨å•æäº¤
            const { username, password } = this
            alert(`ä½ è¾“å…¥çš„ç”¨æˆ·åæ˜¯ï¼š${username.value},ä½ è¾“å…¥çš„å¯†ç æ˜¯ï¼š${password.value}`)
        }
    }
	//æ¸²æŸ“ç»„ä»¶
	ReactDom.render(<login/>, document.getElementId('test'))
</script>
```

#### å—æ§ç»„ä»¶

> éšç€ä½ çš„è¾“å…¥ï¼Œä¸æ–­ç»´æŠ¤çŠ¶æ€ï¼ˆstateï¼‰

> çœç•¥ref

```javascript
<script type="text/babel">
    // åˆ›å»ºç»„ä»¶
    class Login extends React.Component{
        state = {
            username: '',
            password: ''
        }
        savePassword = (event) => {
            this.setState({username:event.target.value})
        }
        savePassword = (event) => {
            this.setState({password:event.target.value})
        }
        handleSubmit = (event) => {
            event.preventDefault()
            const {username,password} = this.state
            alert(`ä½ è¾“å…¥çš„ç”¨æˆ·åæ˜¯ï¼š${username},ä½ è¾“å…¥çš„å¯†ç æ˜¯ï¼š${password}`)
        }
        render() {
            <form onSubmit={this.handleSubmit}>
                ç”¨æˆ·åï¼š<input onChange={this.saveUsername} type="text" name="username"/>
                å¯†ç ï¼š<input onChange={this.savePassword} type="passwod" name="password"/>
                <button>ç™»é™†</button>    
            </form>    
        }
    }
    // æ¸²æŸ“ç»„ä»¶
	ReactDOM.render(<Login/>,document.getElementById('test'))
</script>
```

#### é«˜é˜¶å‡½æ•°/æŸ¯é‡ŒåŒ–

- é«˜é˜¶å‡½æ•°ï¼ˆç¬¦åˆä»¥ä¸‹å…¶ä¸­ä¸€ä¸ªï¼Œå°±æ˜¯é«˜é˜¶ï¼‰

  - Aå‡½æ•°ï¼Œæ¥å—çš„å‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°
  - Aå‡½æ•°ï¼Œè¿”å›å€¼ä¾ç„¶æ˜¯ä¸ªå‡½æ•°

  > Promiseã€setTimeoutã€arr.map()ã€arr.filter()ç­‰ç­‰

- æŸ¯é‡ŒåŒ–

  ```javascript
  // æ­£å¸¸å†™æ³•
  function sum(a,b,c){
      return a + b + c
  }
  // æŸ¯é‡ŒåŒ–
  function sum(a) {
      return (b)=>{
          return (c)=>{
              return a+b+c
          }
      }
  }
  const result = sum(1)(2)(3)
  ```

  ![img](https://staticqn.qizuang.com/custom/20220505/Fm2P2CgbEF219tBsm863ot1iSiHH)

  ```javascript
  <script type="text/babel">
      // åˆ›å»ºç»„ä»¶
      class Login extends React.Component{
          state = {
              username: '',
              password: ''
          }
          saveFormData = (dataType) => {
              return (event)=>{
                  this.setState({[dataType]: event.target.value})
              }
          }
          //è¡¨å•æäº¤çš„å›è°ƒ
          handleSubmit = (event)=>{
              event.preventDefault() //é˜»æ­¢è¡¨å•æäº¤
              const {username,password} = this.state
              alert(`ä½ è¾“å…¥çš„ç”¨æˆ·åæ˜¯ï¼š${username},ä½ è¾“å…¥çš„å¯†ç æ˜¯ï¼š${password}`)
          }
          render() {
              return(
              	<form onSubmit = {this.handleSubmit}>
                  	ç”¨æˆ·åï¼š<input onChange={this.saveFormData('username')} type="text" name="username"/>
                      å¯†ç ï¼š<input onChange={this.saveFormData('password')} type="password" name="password"/>
                      <button>ç™»é™†</button>    
                  </form>
              )
          }
      }
      // æ¸²æŸ“ç»„ä»¶
  </script>    
  ```


#### ä¸ä½¿ç”¨æŸ¯é‡ŒåŒ–

```javascript
<script type="text/babel">
	//åˆ›å»ºç»„ä»¶
	class Login extends React.Component{
		//åˆå§‹åŒ–çŠ¶æ€
		state = {
			username:'', //ç”¨æˆ·å
			password:'' //å¯†ç 
		}

		//ä¿å­˜è¡¨å•æ•°æ®åˆ°çŠ¶æ€ä¸­
		saveFormData = (dataType,event)=>{
			this.setState({[dataType]:event.target.value})
		}

		//è¡¨å•æäº¤çš„å›è°ƒ
		handleSubmit = (event)=>{
			event.preventDefault() //é˜»æ­¢è¡¨å•æäº¤
			const {username,password} = this.state
			alert(`ä½ è¾“å…¥çš„ç”¨æˆ·åæ˜¯ï¼š${username},ä½ è¾“å…¥çš„å¯†ç æ˜¯ï¼š${password}`)
		}
		render(){
			return(
				<form onSubmit={this.handleSubmit}>
					ç”¨æˆ·åï¼š<input onChange={event => this.saveFormData('username', event)} type="text" name="username"/>
					å¯†ç ï¼š<input onChange={event => this.saveFormData('password', event)} type="password" name="password"/>
					<button>ç™»å½•</button>
				</form>
			)
		}
	}
	//æ¸²æŸ“ç»„ä»¶
	ReactDOM.render(<Login/>,document.getElementById('test'))
</script>
```

#### ç”Ÿå‘½å‘¨æœŸ

```javascript
<script type="text/babel">
    // åˆ›å»ºç»„ä»¶
    class Life extends React.Component {
        state = { opacity: 1 }
        death = ()=>{
            ReactDOM.ummountComponentAtNode(document.getElementById('test'))
        }
        // ç»„ä»¶æŒ‚è½½å®Œæ¯•
        componentDidMount() {
            this.timer = setInterval(()=>{
                let {opacity} = this.state
                opacity -= 0.1
                if(opacity <= 0) opacity = 1
                this.setState({opacity})
            },200)
        }
        componentWillUnmount(){
            clearInterval(this.timer)
        }
        render(){
            return (
            	<div>
                	<h2 style={{opacity: this.state.opacity}}>æˆ‘çˆ±èŒƒå†°å†°</h2>
                    <button onClick={this.death}>ä¸æ´»äº†</button>
                </div>
            )
        }
    }
    // æ¸²æŸ“ç»„ä»¶
    ReactDOm.render(<Life/>, document.getElementById('test'))
</script> 
```

#### reactç”Ÿå‘½å‘¨æœŸï¼ˆæ—§ï¼‰

1. åˆå§‹åŒ–é˜¶æ®µ

   - constructor()

   - componentWillMount()

   - render()

   - componentDidMound()    å¸¸ç”¨

     ä¸€èˆ¬åœ¨è¿™ä¸ªé’©å­ä¸­åšä¸€äº›åˆå§‹åŒ–çš„äº‹ï¼Œä¾‹å¦‚ï¼š å¼€å¯å®šæ—¶å™¨ï¼Œå‘é€ç½‘ç»œè¯·æ±‚ï¼Œè®¢é˜…æ¶ˆæ¯

2. æ›´æ–°é˜¶æ®µ

   > ç”±ç»„ä»¶å†…éƒ¨`this.setSate`æˆ–çˆ¶ç»„ä»¶renderè§¦å‘

   - shouldComponentUpdate()
   - componentWillUpdate()
   - render()
   - componentDidUpdate()

3. å¸è½½ç»„ä»¶

   > ç”±ReactDOM.unmountComponentAtNode() è§¦å‘

   - componentWillUnmount()  å¸¸ç”¨

     ä¸€èˆ¬åœ¨è¿™ä¸ªé’©å­åšä¸€äº›æ”¶å°¾çš„äº‹ï¼Œä¾‹å¦‚ï¼š å…³é—­å®šæ—¶å™¨ï¼Œå–æ¶ˆè®¢é˜…æ¶ˆæ¯

#### reactç”Ÿå‘½å‘¨æœŸï¼ˆæ–°ï¼‰

1. åˆå§‹åŒ–é˜¶æ®µ

   - constructor()

   - getDerivedStateFromProps

     > å­—é¢è®°å¿†: å³stateçš„å€¼åœ¨**ä»»ä½•æ—¶å€™**éƒ½å–å†³äºprops
     >
     > get(è·å–) -   Derived(å…¨éƒ¨æ¥æº) - State - From-Props

   - render()

   - componentDidMount()

2. æ›´æ–°é˜¶æ®µ

   - getDerivedStateFromProps

   - shouldComponentUpdate()

   - render()

   - getSnapshotBeforeUpdate

     > snapshot: å¿«ç…§
     >
     > åœ¨æœ€è¿‘ä¸€æ¬¡æ¸²æŸ“è¾“å‡ºï¼ˆæäº¤åˆ°DOMèŠ‚ç‚¹ï¼‰ä¹‹å‰è°ƒç”¨ã€‚å®ƒä½¿å¾—ç»„ä»¶èƒ½åœ¨å‘ç”Ÿæ”¹å˜ä¹‹å‰ä»DOMä¸­æ•è·ä¸€äº›ä¿¡æ¯ï¼ˆä¾‹å¦‚.æ»šåŠ¨ä½ç½®ï¼‰

   - componentDidUpdate()

3. å¸è½½ç»„ä»¶

   - componentWillUnmount()

```javascript
// å³å°†åºŸå¼ƒçš„é’©å­
1.componentWillMount
2.componentWillReceiveProps
3.componentWillUpdate
// åœ¨æ–°çš„ç‰ˆæœ¬ä¸­éœ€è¦åŠ ä¸Š UNSAFE_ å‰ç¼€æ‰èƒ½ä½¿ç”¨ï¼Œå¯èƒ½ä»¥åä¼šåºŸå¼ƒ
// UNSAFEä¸æ˜¯æŒ‡å®‰å…¨æ€§ï¼Œè€Œæ˜¯è¡¨ç¤ºè¿™äº›ç”Ÿå‘½å‘¨æœŸçš„ä»£ç åœ¨React çš„æœªæ¥ç‰ˆæœ¬ä¸­æ›´æœ‰å¯èƒ½å‡ºç°bugï¼Œå°¤å…¶åœ¨å¼€å¯å¼‚æ­¥æ¸²æŸ“å
```

#### keyçš„ä½œç”¨

1. keyæ˜¯è™šæ‹ŸDOMå¯¹è±¡çš„æ ‡è¯†ï¼Œåœ¨æ›´æ–°æ˜¾ç¤ºæ—¶keyèµ·ç€æå…¶é‡è¦çš„ä½œç”¨

2. è¯¦ç»†çš„è¯´: å½“çŠ¶æ€ä¸­æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œreactä¼šæ ¹æ® æ–°æ•°æ® ç”Ÿæˆ æ–°çš„è™šæ‹ŸDOM

   â€‹                  éšåReact è¿›è¡Œ æ–°è™šæ‹ŸDOM ä¸ æ—§è™šæ‹ŸDOM diffæ¯”è¾ƒï¼Œæ¯”è¾ƒè§„åˆ™å¦‚ä¸‹

   - æ—§è™šæ‹ŸDOMä¸­æ‰¾åˆ°äº†ä¸æ–°è™šæ‹ŸDOMç›¸åŒçš„key
     - è‹¥è™šæ‹ŸDOMä¸­å†…å®¹æ²¡å˜ï¼Œç›´æ¥ä½¿ç”¨ä¹‹å‰çš„çœŸå®çš„DOM
     - è‹¥è™šæ‹ŸDOMä¸­å†…å®¹å˜äº†ï¼Œåˆ™ç”Ÿæˆæ–°çš„çœŸå®DOMï¼Œéšåæ›¿æ¢é¡µé¢ä¸­ä¹‹å‰çœŸå®DOM
   - æ—§è™šæ‹ŸDOMä¸­æœªæ‰¾åˆ°ä¸æ–°è™šæ‹ŸDOMç›¸åŒçš„key
     - æ ¹æ®æ•°æ®åˆ›å»ºæ–°çš„çœŸå®DOMï¼Œéšåæ¸²æŸ“åˆ°é¡µé¢

#### ç”¨indexå¯èƒ½å¼•å‘çš„é—®é¢˜

1. å¯¹æ•°æ®è¿›è¡Œï¼š é€†åºæ·»åŠ ï¼Œé€†åºåˆ é™¤ç­‰ç ´åæ“ä½œ

   > ä¼šäº§ç”Ÿæ²¡æœ‰å¿…è¦çš„çœŸå®DOMæ›´æ–°  ==ã€‹ ç•Œé¢æ•ˆæœæ²¡é—®é¢˜ï¼Œä½†æ•ˆç‡ä½

2. å¦‚æœç»“æ„ä¸­è¿˜åŒ…å«è¾“å…¥ç±»çš„DOM

   > ä¼šäº§ç”Ÿé”™è¯¯çš„DOMæ›´æ–° ==ã€‹ ç•Œé¢æœ‰é—®é¢˜

3. æ³¨æ„ï¼Œå¦‚æœåªæ˜¯ç”¨æ¥å±•ç¤ºæ“ä½œï¼Œç”¨`index`ä½œä¸ºkeyå€¼æ˜¯æ²¡æœ‰é—®é¢˜çš„



## æ‰©å±•

#### srcæ–‡ä»¶å¤¹ä»‹ç»

- public

  ```javascript
  index.html // ä¸»é¡µé¢
  manifest.json // åº”ç”¨åŠ å£³æ–‡ä»¶
  robots.txt // çˆ¬è™«åè®®æ–‡ä»¶
  ```

- src

  ```javascript
  App.js // Appç»„ä»¶
  index.js // å…¥å£æ–‡ä»¶
  App.text.js // ç”¨äºç»™Appåšæµ‹è¯•
  reprotWebVitals.js // é¡µé¢æ€§èƒ½åˆ†ææ–‡ä»¶ï¼ˆéœ€web-vitalsåº“çš„æ”¯æŒï¼‰
  setupTests.js // ç»„ä»¶å•å…ƒæµ‹è¯•çš„æ–‡ä»¶ï¼ˆéœ€è¦jest-domåº“çš„æ”¯æŒï¼‰
  ```


#### é…ç½®ä»£ç†æ–¹å¼

1. æ–¹æ³•ä¸€

   > åœ¨package.jsonä¸­è¿½åŠ å¦‚ä¸‹é…ç½®

   ```json
   {
       "proxy": "http://loclhost:5000"
   }
   ```

   > è¯´æ˜

   - ä¼˜ç‚¹ï¼š é…ç½®ç®€å•ï¼Œå‰ç«¯è¯·æ±‚èµ„æºå¯ä»¥ä¸åŠ ä»»ä½•å‰ç¼€
   - ç¼ºç‚¹ï¼š ä¸èƒ½é…ç½®å¤šä¸ªä»£ç†
   - å·¥ä½œæ–¹å¼ï¼š ä¸Šè¯‰æ–¹å¼é…ç½®ä»£ç†ï¼Œå½“è¯·æ±‚äº†3000ä¸å­˜åœ¨çš„èµ„æºæ—¶ï¼Œé‚£ä¹ˆè¯¥è¯·æ±‚ä¼šè½¬å‘ç»™5000ï¼ˆä¼˜å…ˆåŒ¹é…å‰ç«¯èµ„æºï¼‰

2. æ–¹æ³•äºŒ

   - åˆ›å»ºä»£ç†æ–‡ä»¶

     åœ¨srcä¸‹åˆ›å»ºé…ç½®æ–‡ä»¶ï¼š `src/setupProxy.js`

   - ç¼–å†™setupProxy.jsé…ç½®å…·ä½“ä»£ç†è§„åˆ™

     ```javascript
     const proxy = require('http-proxy-middleware')
     
     module.exports = function(app) {
         app.use(
         	proxy('/api1',{ //api1æ˜¯éœ€è¦è½¬å‘çš„è¯·æ±‚ï¼ˆæ‰€æœ‰ï¼‰
                 target: 'http://localhost: 5000', // é…ç½®è½¬å‘ç›®æ ‡åœ°å€
                 changeOrigin: true, //æ§åˆ¶æœåŠ¡å™¨æ¥æ”¶åˆ°çš„è¯·æ±‚å¤´ä¸­hostå­—æ®µçš„å€¼
                 /*
              	changeOriginè®¾ç½®ä¸ºtrueæ—¶ï¼ŒæœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚å¤´ä¸­çš„hostä¸ºï¼šlocalhost:5000
              	changeOriginè®¾ç½®ä¸ºfalseæ—¶ï¼ŒæœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚å¤´ä¸­çš„hostä¸ºï¼šlocalhost:3000
              	changeOriginé»˜è®¤å€¼ä¸ºfalseï¼Œä½†æˆ‘ä»¬ä¸€èˆ¬å°†changeOriginå€¼è®¾ä¸ºtrue
              	*/
                 pathRewrite: {'^/api1': ''} // å»é™¤è¯·æ±‚å‰ç¼€ï¼Œä¿è¯äº¤ç»™åå°æœåŠ¡å™¨çš„æ˜¯æ­£å¸¸è¯·æ±‚åœ°å€ï¼ˆå¿…é¡»é…ç½®ï¼‰
             })ï¼Œ
             proxy('/api2',{
             	target: 'http://localhost:5001',
             	changeOrigin: true,
             	pathRewrite: {'^/api2': ''}
             })
         )
     }
     ```

   > è¯´æ˜

   - ä¼˜ç‚¹ï¼š å¯ä»¥é…ç½®å¤šä¸ªä»£ç†ï¼Œå¯ä»¥çµæ´»çš„æ§åˆ¶è¯·æ±‚æ˜¯å¦èµ°ä»£ç†
   - ç¼ºç‚¹ï¼š é…ç½®ç¹çï¼Œå‰ç«¯è¯·æ±‚èµ„æºæ—¶å¿…é¡»åŠ å‰ç¼€

#### æ¶ˆæ¯è®¢é˜…å‘å¸ƒ

- å·¥å…·åº“ï¼šPubSubJS

- ä¸‹è½½ï¼šnpm install pubsub-js --save

- ä½¿ç”¨

  ```javascript
  import PubSub from 'pubsub-js' // å¼•å…¥
  this.token = PubSub.subscribe('delete',function(data){}) // è®¢é˜…
  PubSub.publish('delete',data) // å‘å¸ƒæ¶ˆæ¯
  
  componentWillUnmount() {
      PubSub.unsubscribe(this.token) // å–æ¶ˆè®¢é˜…
  }
  ```

#### Fetch

- **æ¦‚å¿µ**

  - å…³æ³¨åˆ†ç¦»

    `XMLHttpRequest`é…ç½®ä¸è°ƒç”¨æ–¹å¼æ··ä¹±

  - å¼‚æ­¥æ¨¡å‹

    `Promise`     `generator/yield`   `async/awiat`

- **API**

  - getè¯·æ±‚

    ```javascript
    fetch(url).then(function(response){
        return response.json()
    }).then(function(data){
        console.log(data)
    }).catch(function(e){
        console.log(e)
    })
    ```

  - postè¯·æ±‚

    ```javascript
    fetch(url, {
        method: 'post',
        body:JSON.stringify(data)
    }).then(function(data){
        console.log(data)
    }).catch(function(e){
        console.log(e)
    })
    ```

  - fetchå‘é€ï¼ˆä¼˜åŒ–ï¼‰

    ```javascript
    try{
    	const response = await fetch(url)
    	const data = await response.json()
    } catch (error){
    	console.log('è¯·æ±‚å‡ºé”™', error)
    }
    ```

## Reactè·¯ç”±

#### SPAçš„ç†è§£

- å•é¡µWebåº”ç”¨ï¼ˆsingle page web application, SPAï¼‰
- æ•´ä¸ªåº”ç”¨åªæœ‰ä¸€ä¸ªå®Œæ•´çš„é¡µé¢
- ç‚¹å‡»é¡µé¢ä¸­çš„é“¾æ¥ä¸ä¼šåˆ·æ–°é¡µé¢ï¼Œåªä¼šåšé¡µé¢çš„å±€éƒ¨æ›´æ–°
- æ•°æ®éƒ½éœ€è¦é€šè¿‡ajaxè¯·æ±‚è·å–ï¼Œå¹¶åœ¨å‰ç«¯å¼‚æ­¥å±•ç°

#### react-router-domçš„ç†è§£

- reactçš„ä¸€ä¸ªæ’ä»¶åº“
- ä¸“é—¨ç”¨æ¥å®ç°ä¸€ä¸ªSPAåº”ç”¨
- åŸºäºreactçš„é¡¹ç›®åŸºæœ¬éƒ½ä¼šç”¨åˆ°æ­¤åº“

#### react-route-domç›¸å…³API

- å†…ç½®ç»„ä»¶

  1. `<BrowserRouter>`

  2. `<HashRouter>`

  3. `<Route>`

  4. `<Redirect>`

  5. `<Link>`

  6. `<NavLink>`

     è·¯ç”±ç‚¹å‡»çš„é«˜äº®ï¼Œé€šè¿‡activeClassNameæŒ‡å®šæ ·å¼

  7. `<Switch>`

     Switchå¯ä»¥æé«˜è·¯ç”±åŒ¹é…æ•ˆç‡ï¼ˆå•ä¸€åŒ¹é…ï¼‰

- è·¯ç”±çš„åŸºæœ¬ä½¿ç”¨

  > åŸºæœ¬ç•Œé¢

  ```javascript
  // ç¼–å†™è·¯ç”±é“¾æ¥  
  <Link className="list-group-item" to="/about">About</Link>
  <Link className="list-group-item" to="/home">Home</Link>
  
  // æ³¨å†Œè·¯ç”±
  <Route path="/about" component={About}/>
  <Route path="/home" component={Home}/>
  ```
  
  > ä¸»é¡µé¢
  
  ```javascript
  ReactDOM.render(
  	<BrowserRouter>
      	<APP/>
      </BrowserRouter>,
      document.getElementById('root')
  )
  ```
  
- è·¯ç”±ç»„ä»¶å’Œæ™®é€šç»„ä»¶åŒºåˆ«

  - å†™æ³•ä¸åŒ

    ä¸€èˆ¬ç»„ä»¶ï¼š `<Demo/>`

    è·¯ç”±ç»„ä»¶ï¼š`<Route path="/demo"  component={Demo}/>`

  - å­˜æ”¾ä½ç½®ä¸åŒ

    ä¸€èˆ¬ç»„ä»¶ï¼š`components`

    è·¯ç”±ç»„ä»¶ï¼š`pages`

  - æ¥æ”¶åˆ°çš„propsä¸åŒ

    ä¸€èˆ¬ç»„ä»¶ï¼šå†™ç»„ä»¶æ ‡ç­¾æ—¶ä¼ é€’äº†ä»€ä¹ˆï¼Œå°±èƒ½æ”¶åˆ°ä»€ä¹ˆ

    è·¯ç”±ç»„ä»¶ï¼š æ¥æ”¶åˆ°ä¸‰ä¸ªå›ºå®šçš„å±æ€§

    ```javascript
    history:
            go: f go(n)
            goBack: f goBack()
            goForward: f goForward()
            push: f push(path, state)
            replace: f replace(path, state)
    location: 
            pathname: "/about"
            search: ""
            state: undefined
    match:
            params: {}
            path: "/about"
            url: "/about"
    ```

#### æ ‡ç­¾ä½“å†…å®¹children

- é€šè¿‡this.porps.children å¯ä»¥è·å–æ ‡ç­¾ä½“å†…å®¹

#### è§£å†³è·¯ç”±åˆ·æ–°æ ·å¼ä¸¢å¤±é—®é¢˜

- public/index.html ä¸­å¼•å…¥æ ·å¼æ—¶ï¼Œä¸å†™ `./`, å†™ `/`  å¸¸ç”¨
- public/index.html ä¸­å¼•å…¥æ ·å¼æ—¶ï¼Œä¸å†™`./`, å†™`%PUBLIC_URL%`
- ä½¿ç”¨`HashRouter`

#### è·¯ç”±çš„ä¸¥æ ¼åŒ¹é…ä¸æ¨¡ç³ŠåŒ¹é…

- é»˜è®¤ä½¿ç”¨çš„æ˜¯æ¨¡ç³ŠåŒ¹é…
- å¼€å¯ä¸¥æ ¼åŒ¹é…ï¼š`<Route exact={true} path="/about" component={About}/>`
- ä¸¥æ ¼åŒ¹é…ä¸è¦éšä¾¿å¼€å¯ï¼Œéœ€è¦å†å¼€ï¼Œæœ‰æ—¶å€™å¼€å¯ä¼šå¯¼è‡´æ— æ³•ç»§ç»­åŒ¹é…äºŒçº§è·¯ç”±

#### é‡å®šå‘

```javascript
<Redirect to="/home">
```

#### è·¯ç”±ä¼ é€’å‚æ•°

- paramå‚æ•°

  ```javascript
  è·¯ç”±é“¾æ¥ï¼ˆæºå¸¦å‚æ•°ï¼‰: <Link to ={`demo/test/tom/${msgObj.id}`}>å»å“ªå„¿</Link>
  æ³¨å†Œè·¯ç”±ï¼ˆæ— éœ€å£°æ˜ï¼Œæ­£å¸¸æ³¨å†Œå³å¯ï¼‰ï¼š<Route path="/demo/test/:name/:age" component={Test}/>
  æ¥æ”¶å‚æ•°ï¼šthis.props.match.params
  ```

- searchå‚æ•°

  ```javascript
  è·¯ç”±é“¾æ¥ï¼ˆæºå¸¦å‚æ•°ï¼‰ï¼š<Link to='/demo/test?name=tom&age=18'>è¯¦æƒ…</Link>
  æ³¨å†Œè·¯ç”±ï¼ˆæ— éœ€å£°æ˜ï¼Œæ­£å¸¸æ³¨å†Œå³å¯ï¼‰ï¼š<Route path="/demo/test" component={Test}/>
  æ¥æ”¶å‚æ•°ï¼š this.props.location.search    
  å¤‡æ³¨ï¼šè·å–åˆ°çš„searchæ˜¯urlencodedç¼–ç å­—ç¬¦ä¸²ï¼Œéœ€è¦å€ŸåŠ©querystring è§£æ
  ```

- stateä¼ é€’

  ```
  è·¯ç”±é“¾æ¥ï¼ˆæºå¸¦å‚æ•°ï¼‰ï¼š<Link to={{path:'/demo/test', state:{name: 'tom', age: 18}}}>è¯¦æƒ…</Link>
  æ³¨å†Œè·¯ç”±ï¼ˆæ— éœ€å£°æ˜ï¼Œæ­£å¸¸æ³¨å†Œå³å¯ï¼‰ï¼š<Route path="/demo/test" component={{Test}}/>
  æ¥æ”¶å‚æ•°ï¼š this.pops.location.state
  å¤‡æ³¨ï¼š åˆ·æ–°ä¹Ÿå¯ä»¥ä¿ç•™å‚æ•°ï¼Œä½†æ˜¯åœ¨ HashRouter ä¸‹ä¸ä¼šä¿ç•™
  ```

#### ç¼–ç¨‹å¼è·¯ç”±å¯¼èˆª

> å€ŸåŠ©`this.props.history`å¯¹è±¡ä¸Šçš„APIå¯¹æ“ä½œè·¯ç”±è·³è½¬ï¼Œå‰è¿›ï¼Œåé€€

```javascript
this.props.history.push()
this.props.history.replace()
this.props.history.goBack()
this.props.history.goForward()
this.props.history.go()
```

#### withrouter

> è§£å†³ä¸€èˆ¬ç»„ä»¶ä¸­ä½¿ç”¨è·¯ç”±ç»„ä»¶ç‰¹æœ‰çš„`api`, `withrouter`åŠ å·¥å®Œåæ˜¯ä¸€ä¸ªæ–°ç»„ä»¶

```javascript
import React, { Component } from 'react'
import { withRouter } from 'react-router-dom'

class Header extends Component {
    ...
}

export default withRouter(Header)    
```

#### BrowserRouter å’Œ HashRouteråŒºåˆ«

1. åº•å±‚åŸç†ä¸ä¸€æ ·
   - BrowserRouterä½¿ç”¨çš„æ˜¯H5çš„history API, ä¸å…¼å®¹IE9åŠä»¥ä¸‹ç‰ˆæœ¬
   - HashRouterä½¿ç”¨çš„æ˜¯URLçš„å“ˆå¸Œå€¼
2. urlè¡¨ç°å½¢å¼ä¸ä¸€æ ·
   - BrowerRouterçš„è·¯å¾„ä¸­æ²¡æœ‰#ï¼Œä¾‹å¦‚ï¼šlocalhost: 3000/demo/test 
   - HashRouterçš„è·¯å¾„åŒ…å«#
3. åˆ·æ–°åå¯¹è·¯ç”±stateå‚æ•°çš„å½±å“
   - BrowserRouteræ²¡æœ‰ä»»ä½•å½±å“ï¼Œå› ä¸ºstateä¿å­˜åœ¨historyå¯¹è±¡ä¸­
   - HashRouteråˆ·æ–°åä¼šå¯¼è‡´è·¯ç”±stateå‚æ•°
4. å¤‡æ³¨ï¼š HashRouter å¯ä»¥ç”¨äºè§£å†³ä¸€äº›è·¯å¾„é”™è¯¯ç›¸å…³çš„é—®é¢˜

#### React UI ç»„ä»¶åº“

- material-ui

  [å®˜ç½‘](http://www.material-ui.com/#/)

  [github](https://github.com/callemall/material-ui)

- ant-design (èš‚èšé‡‘æœ)

  [å®˜ç½‘](https://ant.design/index-cn)

  [github](https://github.com/ant-design/ant-design/)

## redux

#### reduxç†è§£

- å­¦ä¹ æ–‡æ¡£

  [ä¸­æ–‡æ–‡æ¡£](http://www.redux.org.cn/)

- redux æ˜¯ä»€ä¹ˆ

  - redux æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºåšçŠ¶æ€ç®¡ç†çš„JSåº“ï¼ˆä¸æ˜¯reactæ’æ¶åº“ï¼‰
  - å®ƒå¯ä»¥ç”¨åœ¨reactã€angularã€vueã€ç­‰é¡¹ç›®ä¸­ï¼Œä½†åŸºæœ¬ä¸reacté…åˆä½¿ç”¨
  - ä½œç”¨ï¼š é›†ä¸­å¼ç®¡ç†reactåº”ç”¨ä¸­å¤šä¸ªç»„ä»¶å…±äº«çš„çŠ¶æ€

- ä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨redux

  - æŸä¸ªç»„ä»¶çš„çŠ¶æ€ï¼Œéœ€è¦è®©å…¶ä»–ç»„ä»¶å¯ä»¥éšæ—¶æ‹¿åˆ°ï¼ˆå…±äº«ï¼‰
  - ä¸€ä¸ªç»„ä»¶éœ€è¦æ”¹å˜å¦ä¸€ä¸ªç»„ä»¶çš„çŠ¶æ€ï¼ˆé€šä¿¡ï¼‰
  - æ€»ä½“åŸåˆ™ï¼š**èƒ½ä¸ç”¨å°±ä¸ç”¨ï¼Œå¦‚æœä¸ç”¨æ¯”è¾ƒåƒåŠ›æ‰è€ƒè™‘ä½¿ç”¨**

- redux åŸç†

  ![img](https://staticqn.qizuang.com/custom/20220509/Fjo4tt1dkdvHz78VWGsrozV3Ngef)

#### æ±‚å’Œæ¡ˆä¾‹_redux ç²¾ç®€ç‰ˆ

1. å®‰è£…

   ```
   yarn add redux
   ```

2. å»é™¤Count ç»„ä»¶è‡ªèº«çš„çŠ¶æ€

   ```react
   import React, {Component} from 'react'
   // å¼•å…¥store from '../../redux/store'
   import store from '../../redux/store'
   
   export default class Count extends Component {
       state = {carName: 'å¥”é©°'}
       /*
       componentDidMount() {
           // æ£€æµ‹åˆ°reduxä¸­çŠ¶æ€çš„å˜åŒ–ï¼Œåªè¦å˜åŒ–ï¼Œå°±è°ƒç”¨render
           store.subscribe(()=>{
               this.setState({})
           })
       }
       */
       // åŠ æ³•
       increment = () => {
           const {value} = this.selectNumber
           store.dispatch({type: 'increment', data: value*1})
       }
       // å‡æ³•
       decrement = () => {
           const {value} = this.selectNumber
           store.dispatch({type: 'decrement', data: value*1})
       }
       // å¥‡æ•°åŠ 
       incrementIfOdd = () => {
           const {value} = this.selectNumber
           const count = store.getState()
           if(count%2 !==0) {
               store.dispatch({type: 'increment', data: value*1})
           }
       }
       // å¼‚æ­¥åŠ 
       incrementAsync = () => {
           cosnt {value} = this.selectNumber
           setTimeout(() => {
               store.dispatch({type: 'incerment', data: value*1})
           }, 500)
       }
       render() {
           return (
           	<div>
   				<h1>å½“å‰æ±‚å’Œä¸ºï¼š{store.getState()}</h1>
   				<select ref={c => this.selectNumber = c}>
   					<option value="1">1</option>
   					<option value="2">2</option>
   					<option value="3">3</option>
   				</select>&nbsp;
   				<button onClick={this.increment}>+</button>&nbsp;
   				<button onClick={this.decrement}>-</button>&nbsp;
   				<button onClick={this.incrementIfOdd}>å½“å‰æ±‚å’Œä¸ºå¥‡æ•°å†åŠ </button>&nbsp;
   				<button onClick={this.incrementAsync}>å¼‚æ­¥åŠ </button>&nbsp;
   			</div>
           )
       }
   }
   ```

   

3. src ä¸‹å»ºç«‹

   ```
   -redux
   	-store.js
   	-count_reducer.js
   ```

4. store.js

   - å¼•å…¥reduxä¸­çš„createStoreå‡½æ•°ï¼Œåˆ›å»ºä¸€ä¸ªstore
   - createStoreè°ƒç”¨æ—¶è¦ä¼ å…¥ä¸€ä¸ªä¸ºå…¶æœåŠ¡çš„reducer
   - è®°å¾—æš´éœ²storeå¯¹è±¡

   ```javascript
   // å¼•å…¥createStrore, ä¸“é—¨ç”¨äºåˆ›å»ºreduxä¸­æœ€ä¸ºæ ¸å¿ƒçš„storeå¯¹è±¡
   import { createStore } from 'redux'
   // å¼•å…¥ä¸ºCountç»„ä»¶æœåŠ¡çš„reducer
   import countReducer from './count_reducer'
   // æš´éœ²store
   export default createStore(countReducer)
   ```

5. count_reducer.js

   - reduerçš„æœ¬è´¨æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ¥æ”¶ï¼špreState, action, è¿”å›åŠ å·¥åçš„çŠ¶æ€
   - æœ‰ä¸¤ä¸ªä½œç”¨ï¼Œåˆå§‹åŒ–çŠ¶æ€ï¼ŒåŠ å·¥çŠ¶æ€
   - reducerè¢«ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶ï¼Œæ˜¯storeè‡ªåŠ¨è§¦å‘çš„
     - ä¼ é€’çš„preStateæ˜¯undefined
     - ä¼ é€’çš„actionæ˜¯ï¼š{ type: '@@REDUX/INIT_a.2.b.4' }

   ```javascript
   // åˆå§‹åŒ–çŠ¶æ€
   const initState = 0
   export default function countReducer ( preState=initstate, action ){
       // ä»actionå¯¹è±¡ä¸­è·å–ï¼š type, data
       const {type, data} = action
       switch(type) {
           case 'increment': //å¦‚æœæ˜¯åŠ 
               return preState + data
           case 'decrement': // å¦‚æœæ˜¯å‡
               return preState - data
           default: 
               return preState
       }
   }
   ```

6. åœ¨index.jsä¸­ç›‘æµ‹storeä¸­çŠ¶æ€çš„æ”¹å˜ï¼Œä¸€æ—¦å‘ç”Ÿæ”¹å˜é‡æ–°æ¸²æŸ“`<App/>`

   å¤‡æ³¨ï¼š reduxåªè´Ÿè´£ç®¡ç†çŠ¶æ€ï¼Œè‡³äºçŠ¶æ€çš„æ”¹å˜é©±åŠ¨é¡µé¢çš„å±•ç¤ºï¼Œéœ€è¦é æˆ‘ä»¬è‡ªå·±å†™

   ```javascript
   store.subscribe(()=>{
   	ReactDOM.render(<App/>, document.getElementById('root'))
   })
   ```


#### actionæ“ä½œ

- æ–°å»ºcount_actionæ“ä½œ

  ```
  export const createIncrementAction = data => ((type: 'increment', data))
  export const createDecrementAction = data => ((type: 'decrement', data))
  ```

- æ–°å»ºå¸¸é‡æ¨¡å—

  ```
  export const INCREMENT = 'increment'
  export const DECREMENT = 'decrement'
  ```

- ç”¨åˆ°å¸¸é‡çš„åœ°æ–¹éƒ½å¼•å…¥å˜é‡

#### å¼‚æ­¥actionå®‰è£…thunk

- å¼‚æ­¥actionå¹¶ä¸æ˜¯å¿…é¡»ä½¿ç”¨çš„

## react-redux

#### react-reduxæ¨¡å‹å›¾

1. æ‰€æœ‰çš„UIç»„ä»¶éƒ½åº”è¯¥åŒ…è£¹ä¸€ä¸ªå®¹å™¨ç»„ä»¶ï¼Œä»–ä»¬æ˜¯çˆ¶å­å…³ç³»
2. å®¹å™¨ç»„ä»¶æ˜¯çœŸæ­£å’Œreduxæ‰“äº¤é“çš„ï¼Œé‡Œé¢å¯ä»¥éšæ„çš„ä½¿ç”¨reduxçš„api
3. UIç»„ä»¶ä¸­ä¸èƒ½ä½¿ç”¨ä»»ä½•reduxçš„api
4. å®¹å™¨ç»„ä»¶ä¼šä¼ ç»™UIç»„ä»¶
   - reduxä¸­æ‰€ä¿å­˜çš„çŠ¶æ€
   - ç”¨äºæ“ä½œçŠ¶æ€çš„æ–¹æ³•
5. å®¹å™¨ç»™UIä¼ é€’ï¼š çŠ¶æ€ã€æ“ä½œçŠ¶æ€çš„æ–¹æ³•ï¼Œå‡é€šè¿‡propsä¼ é€’

#### æ±‚å’Œæ¡ˆä¾‹_react-reduxåŸºæœ¬ä½¿ç”¨

1. æ˜ç¡®ä¸¤ä¸ªæ¦‚å¿µ

   - UIç»„ä»¶ï¼š ä¸èƒ½ä½¿ç”¨ä»»ä½•reduxçš„apiï¼Œåªè´Ÿè´£é¡µé¢çš„å‘ˆç°ï¼Œäº¤äº’ç­‰
   - å®¹å™¨ç»„ä»¶ï¼š è´Ÿè´£å’Œreduxé€šä¿¡ï¼Œå°†ç»“æœäº¤ä¸ªUIç»„ä»¶

2. ä»»ä½•åˆ›å»ºä¸€ä¸ªå®¹å™¨ç»„ä»¶

   - é react-redux çš„ connect å‡½æ•°

     ```
     connect(mapStateToProps, mapDispatchToProps)(UIç»„ä»¶)
     -mapStateToprops: æ˜ å°„çŠ¶æ€ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡
     -mapDispatchToProps: æ˜ å°„æ“ä½œçŠ¶æ€çš„æ–¹æ³•ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡
     ```

3. å®¹å™¨ç»„ä»¶ä¸­çš„storeæ˜¯é propsä¼ è¿›å»çš„ï¼Œè€Œä¸æ˜¯åœ¨å®¹å™¨ç»„ä»¶ä¸­ç›´æ¥å¼•å…¥

#### react-reduxä¼˜åŒ–æ€»ç»“

1.  å®¹å™¨ç»„ä»¶å’ŒUIç»„ä»¶æ•´åˆä¸ºä¸€ä¸ªæ–‡ä»¶

2. æ— éœ€è‡ªå·±ç»™å®¹å™¨ç»„ä»¶ä¼ é€’storeï¼Œç»™`<App/>`åŒ…è£¹ä¸€ä¸ª `<Provider store={store}>`å³å¯

3. ä½¿ç”¨äº†react-reduxåä¹Ÿä¸ç”¨å†ç»™è‡ªæ£€æ£€æŸ¥redux ä¸­çŠ¶æ€çš„æ”¹å˜äº†ï¼Œå®¹å™¨å¯ä»¥è‡ªåŠ¨å®Œæˆ

4. mapDispatchToPropsä¹Ÿå¯ä»¥ç®€å•çš„å†™æˆä¸€ä¸ªå¯¹è±¡

5. ä¸€ä¸ªç»„ä»¶è¦å’Œredux"æ‰“äº¤é“"è¦è­¦å‘Šå‡ æ­¥

   - å®šä¹‰å¥½UIç»„ä»¶ -- ä¸æš´éœ²

   - å¼•å…¥connect ç”Ÿæˆä¸€ä¸ªå®¹å™¨ç»„ä»¶ï¼Œå¹¶æš´éœ²ï¼Œå†™æ³•å¦‚ä¸‹

     ```
     connect( state => ({key: value}), {key:xxxAction} )(UIç»„ä»¶)
     ```

   - åœ¨UIç»„ä»¶æ±‡æ€»é€šè¿‡this.props.xxx  è¯»å–å’Œæ“ä½œçŠ¶æ€

#### çº¯å‡½æ•°

1. ä¸€ç±»ç‰¹åˆ«çš„å‡½æ•°ï¼š åªè¦æ˜¯åŒæ ·çš„è¾“å…¥ï¼ˆå®å‚ï¼‰ï¼Œå¿…å®šå¾—åˆ°åŒæ ·çš„è¾“å‡ºï¼ˆè¿”å›ï¼‰
2. å¿…é¡»éµå®ˆä»¥ä¸‹ä¸€äº›çº¦æŸ
   - ä¸å¾—æ”¹å†™å‚æ•°æ•°æ®
   - ä¸ä¼šäº§ç”Ÿä»»ä½•å‰¯ä½œç”¨ï¼Œä¾‹å¦‚ç½‘ç»œè¯·æ±‚ï¼Œè¾“å…¥å’Œè¾“å‡ºè®¾å¤‡
   - ä¸èƒ½è°ƒç”¨Date.now() æˆ–è€…Math.random() ç­‰ä¸çº¯çš„æ–¹æ³•
3. reduxçš„reducerå‡½æ•°å¿…é¡»æ˜¯ä¸€ä¸ªçº¯å‡½æ•°

## æ‰©å±•

#### setStateæ›´æ–°çŠ¶æ€çš„2ç§å†™æ³•

```javascript
1. setState(stateChange, [callback])  // å¯¹è±¡å¼çš„setState
	stateChange ä¸ºçŠ¶æ€æ”¹å˜å¯¹è±¡ ï¼ˆè¯¥å¯¹è±¡å¯ä»¥ä½“ç°å‡ºçŠ¶æ€çš„æ›´æ”¹ï¼‰
    callbackæ˜¯å¯é€‰çš„å›è°ƒå‡½æ•°ï¼Œå®ƒåœ¨çŠ¶æ€æ›´æ–°å®Œæ¯•ï¼Œç•Œé¢ä¹Ÿæ›´æ–°åï¼ˆrenderè°ƒç”¨åï¼‰æ‰è¢«è°ƒç”¨
    
2. setState(updater, [callback]) //å‡½æ•°å¼çš„setState
	updaterä¸ºè¿”å›stateChangeå¯¹è±¡çš„å‡½æ•°
    updaterå¯ä»¥æ¥æ”¶åˆ°stateå’Œprops
    callbackæ˜¯å¯é€‰çš„å›è°ƒå‡½æ•°ï¼Œå®ƒåœ¨çŠ¶æ€æ›´æ–°ï¼Œç•Œé¢ä¹Ÿæ›´æ–°åï¼ˆrenderè°ƒç”¨åï¼‰æ‰è¢«è°ƒç”¨
```

- å¯¹è±¡å¼çš„setStateæ˜¯å‡½æ•°å¼setStateçš„ç®€å†™æ–¹å¼ï¼ˆè¯­æ³•ç³–ï¼‰

```javascript
import React, {Component} from 'react'

export default class Demo extends Component {
    state = {count: 0}
    add = ()=>{
		// å¯¹è±¡å¼çš„setState
        const {count} = this.state // è·å–åŸæ¥çš„countå€¼
        this.setState({count: count+1},()=>{
            console.log(this.state.count, 'æ‹¿åˆ°çš„æ˜¯é¢„æƒ³çš„')
        })
        console.log(this.state.count, 'æ‹¿åˆ°çš„å€¼ä¸æ˜¯é¢„æƒ³çš„')
        
        // å‡½æ•°å¼çš„setState
        this.setState(state => ({count: state.count + 1}))
    }
    
    render() {
        return (
            <div>
            	<h1>å½“å‰æ±‚å’Œä¸ºï¼š{this.state.count}</h1>
                <button onClick={this.add}>ç‚¹æˆ‘+1</button>
            </div>
        )
    }
}
```

#### è·¯ç”±ç»„ä»¶çš„lazyLoad

```javascript
// é€šè¿‡Reactçš„lazyå‡½æ•°é…åˆ import()å‡½æ•°åŠ¨æ€åŠ è½½è·¯ç”±ç»„ä»¶ ===> è·¯ç”±ç»„ä»¶ä»£ç ä¼šè¢«åˆ†å¼€æ‰“åŒ…
const Login = lazy(()=> import('@/pages/Login'))

// é€šè¿‡<Suspense>æŒ‡å®šåœ¨åŠ è½½å¾—åˆ°è·¯ç”±æ‰“åŒ…æ–‡ä»¶å‰æ˜¾ç¤ºä¸€ä¸ªè‡ªå®šä¹‰çš„loadingç•Œé¢
<Suspense fallback={<h1>loading...</h1>}>
	<Switch>
    	<Route path="/xxx" component={xxx}>
    	<Redirect to="/login">
    </Switch>
</Suspense>                    
```

#### hooks

> å¯ä»¥è®©ä½ åœ¨å‡½æ•°ç»„ä»¶ä¸­ä½¿ç”¨ state ä»¥åŠå…¶ä»–çš„ Reactç‰¹æ€§

- state Hook

  - State Hook è®©å‡½æ•°ç»„ä»¶ä¹Ÿå¯ä»¥æœ‰ stateçŠ¶æ€ï¼Œ å¹¶è¿›è¡ŒçŠ¶æ€æ•°æ®çš„è¯»å†™æ“ä½œ
  - è¯­æ³•ï¼š const [xxx, setXxx]  =  React.useState(initValue)
  - useState() è¯´æ˜
    - å‚æ•°ï¼š ç¬¬ä¸€æ¬¡åˆå§‹åŒ–æŒ‡å®šçš„å€¼åœ¨å†…éƒ¨ä½œç¼“å­˜
    - è¿”å›å€¼ï¼š åŒ…å«ä¸¤ä¸ªå…ƒç´ çš„æ•°ç»„ï¼šç¬¬1ä¸ªä¸ºå†…éƒ¨å½“å‰çŠ¶æ€å€¼ï¼Œç¬¬2ä¸ªä¸ºæ›´æ–°çŠ¶æ€å€¼çš„å‡½æ•°
  - setXxx() ä¸¤ç§å†™æ³•

  ```javascript
  import React from 'react'
  import ReactDom from 'react-dom'
  
  function Demo(){
  	const [count, setCount] = React.useState(0)
      const myRef = React.useRef()
      
      React.useEffect(()=>{
          let timer = setInterVal(()=>{
              setCount(count => count + 1)
          }, 1000)
          return ()=>{
              clearInterval(timer)
          }
      },[])
      // åŠ çš„å›è°ƒ
      function add() {
          // setCount(count + 1) // ç¬¬ä¸€ç§å†™æ³•
          setCount(count => count + 1)
      }
      // æç¤ºè¾“å…¥çš„å›è°ƒ
      function show() {
          alert(myRef.current.value)
      }
      // å¸è½½ç»„ä»¶çš„å›è°ƒ
      function unmount() {
          ReactDOM.unmountComponentAtNode(document.getElementById('root'))
      }
      return (
      	<div>
          	<input type="text" ref={myRef}/>
              <h2>å½“å‰æ±‚å’Œä¸ºï¼š {count}</h2>
              <button onClick-{add}>ç‚¹æˆ‘ + 1</button>
              <button onClick={unmout}>å¸è½½ç»„ä»¶</button>
              <button onClick={show}>ç‚¹æˆ‘æç¤ºæ•°æ®</button>
          </div>
      )
  }
  export default Demo
  ```

- Effect Hook

  - Effect Hook å¯ä»¥è®©ä½ åœ¨å‡½æ•°ç»„ä»¶ä¸­æ‰§è¡Œå‰¯ä½œç”¨æ“ä½œï¼ˆç”¨äºæ¨¡æ‹Ÿç±»ç»„ä»¶ä¸­çš„ç”Ÿå‘½å‘¨æœŸé’©å­ï¼‰

  - Reactä¸­çš„å‰¯ä½œç”¨æ“ä½œ

    - å‘ajaxè¯·æ±‚æ•°æ®è·å–
    - è®¾ç½®è®¢é˜…/å¯åŠ¨å®šæ—¶å™¨
    - æ‰‹åŠ¨æ›´æ”¹çœŸå®DOM

  - è¯­æ³•å’Œè¯´æ˜

    ```javascript
    useEffect(()=>{
        // åœ¨æ­¤å¯ä»¥æ‰§è¡Œä»»ä½•å¸¦å‰¯ä½œç”¨æ“ä½œ
        return () => {
            //åœ¨æ­¤åšä¸€äº›æ”¶å°¾å·¥ä½œï¼Œæ¯”å¦‚æ¸…é™¤å®šæ—¶å™¨/å–æ¶ˆè®¢é˜…ç­‰
        }
    },[stateValue]) // å¦‚æœæŒ‡å®šçš„æ˜¯[],å›è°ƒå‡½æ•°åªä¼šåœ¨ç¬¬ä¸€æ¬¡renderï¼ˆï¼‰åæ‰§è¡Œ
    ```

  - å¯ä»¥æŠŠ userEffect Hook çœ‹ä½œå¦‚ä¸‹ä¸‰ä¸ªå‡½æ•°çš„ç»„åˆ

    component DidMount()

    component DidUpdate()

    component WillUnmount()

- Ref Hook

  - Ref Hook å¯ä»¥åœ¨å‡½æ•°ç»„ä»¶ä¸­å­˜å‚¨ã€æŸ¥æ‰¾ç»„ä»¶å†…çš„æ ‡ç­¾æˆ–äººå‘˜å…¶ä»–æ•°æ®
  - è¯­æ³•ï¼š const refContainer = useRef()
  - ä½œç”¨ï¼šä¿å­˜æ ‡ç­¾å¯¹è±¡ï¼ŒåŠŸèƒ½ä¸React.createRef() ä¸€æ ·

#### Fragment

- ä½¿ç”¨

  ```
  <Fragment></Fragment>
  <></>
  ```

- ä½œç”¨

  å¯ä»¥ä¸ç”¨å¿…é¡»æœ‰ä¸€ä¸ªçœŸå®çš„DOMæ ¹èŠ‚ç‚¹ï¼Œå‡å°‘å±‚çº§åµŒå¥—

#### Context

- ç†è§£

  ä¸€ç§ç»„ä»¶é—´é€šä¿¡æ–¹å¼ï¼Œå¸¸ç”¨äº ç¥–ç»„ä»¶ ä¸ åä»£ç»„ä»¶é—´é€šä¿¡

- ä½¿ç”¨

  ```javascript
  // åˆ›å»ºContextå®¹å™¨å¯¹è±¡
  	const XxxContext = React.creteContext()
  // æ¸²æŸ“å­ç»„ä»¶æ—¶ï¼Œå¤–é¢åŒ…è£¹ xxxContext.Provider, é€šè¿‡valueå±æ€§ç»™åä»£ç»„ä»¶ä¼ é€’æ•°æ®ï¼š
  	<xxxContext.Provider value={æ•°æ®}>
  		å­ç»„ä»¶
  	</xxxContext.Provider>
  // åä»£ç»„ä»¶è¯»å–æ•°æ®
  	// ç±»ç»„ä»¶
  	static contextType = xxxContext
  	this.context
  	 
  	// å‡½æ•°ç»„ä»¶
  	<xxxContext.Consumer>
          {
          	value => (è¦æ˜¾ç¤ºçš„å†…å®¹)
      	}
      </xxxContext.Consumer>    
  ```

- æ³¨æ„

  > åœ¨åº”ç”¨å¼€å‘ä¸­ä¸€èˆ¬ä¸ç”¨contextï¼Œä¸€èˆ¬éƒ½ç”¨å®ƒçš„å°è£…reactæ’ä»¶

#### ç»„ä»¶ä¼˜åŒ–

- Componentçš„2ä¸ªé—®é¢˜

  - åªè¦æ‰§è¡Œ setStateï¼ˆï¼‰ï¼Œå³ä½¿ä¸æ”¹å˜çŠ¶æ€æ•°æ®ï¼Œç»„ä»¶ä¹Ÿä¼šé‡æ–°renderï¼ˆï¼‰===> æ•ˆç‡ä½
  - åªè¦å½“å‰ç»„ä»¶é‡æ–°renderï¼ˆï¼‰ï¼Œ å°±ä¼šè‡ªåŠ¨é‡æ–°renderå­ç»„ä»¶ï¼Œçºµä½¿å­ç»„ä»¶æ²¡æœ‰ç”¨åˆ°çˆ¶ç»„ä»¶çš„ä»»ä½•æ•°æ® ===> æ•ˆç‡ä½

- æ•ˆç‡é«˜çš„åšæ³•

  åªæœ‰å½“ç»„ä»¶çš„stateæˆ–propsæ•°æ®å‘ç”Ÿå˜åŒ–æ—¶æ‰é‡æ–°renderï¼ˆï¼‰

- åŸå› 

  Compenentä¸­çš„shouldComponentUpdate() æ€»æ˜¯è¿”å›true

- è§£å†³

  ```javascript
  // åŠæ³•1
  é‡å†™shouldComponentUpdate()æ–¹æ³•
  æ¯”è¾ƒæ–°æ—§stateæˆ–porpsæ•°æ®ï¼Œå¦‚æœæœ‰å˜åŒ–æ‰è¿”å›true,å¦‚æœæ²¡æœ‰è¿”å›false
  
  // åŠæ³•2
  ä½¿ç”¨PureComponent
  PureComponenté‡å†™äº†shouldComponentUpdate(),åªæœ‰stateæˆ–propsæ•°æ®æœ‰å˜åŒ–æ‰è¿”å›true
  	æ³¨æ„ï¼š
      	åªæ˜¯è¿›è¡Œstateå’Œpropsæ•°æ®çš„æµ…æ¯”è¾ƒï¼Œå¦‚æœåªæ˜¯æ•°æ®å¯¹è±¡å†…éƒ¨æ•°æ®å˜äº†ï¼Œè¿”å›false
          ä¸è¦ç›´æ¥ä¿®æ”¹stateæ•°æ®ï¼Œè€Œæ˜¯è¦äº§ç”Ÿæ–°æ•°æ®
  
  é¡¹ç›®ä¸­ä¸€èˆ¬ä½¿ç”¨PureComponent æ¥ä¼˜åŒ–        
  ```

#### render props

- å¦‚ä½•å‘ç»„ä»¶å†…éƒ¨åŠ¨æ€ä¼ å…¥å¸¦å†…å®¹çš„ç»“æ„ï¼ˆæ ‡ç­¾ï¼‰

  ```
  Vueä¸­
  	ä½¿ç”¨slot æŠ€æœ¯
  Reactä¸­
  	ä½¿ç”¨children props: é€šè¿‡ç»„ä»¶æ ‡ç­¾ä½“ä¼ å…¥ç»“æ„
  	ä½¿ç”¨render props: é€šè¿‡ç»„ä»¶æ ‡ç­¾å±æ€§ä¼ å…¥ç»“æ„ï¼Œè€Œä¸”å¯ä»¥æºå¸¦æ•°æ®ï¼Œä¸€èˆ¬ç”¨renderå‡½æ•°å±æ€§
  ```

- children props

- render props

#### é”™è¯¯è¾¹ç•Œ

- ç†è§£

  é”™è¯¯è¾¹ç•Œï¼ˆError boundaryï¼‰: ç”¨æ¥æ•è·åä»£ç»„ä»¶é”™è¯¯ï¼Œæ¸²æŸ“å‡ºå¤‡ç”¨é¡µé¢

- ç‰¹ç‚¹

  åªèƒ½æ•è·åä»£ç»„ä»¶å£°æ˜å‘¨æœŸäº§ç”Ÿçš„é”™è¯¯ï¼Œä¸èƒ½æ•è·è‡ªå·±ç»„ä»¶äº§ç”Ÿçš„é”™è¯¯å’Œå…¶ä»–ç»„ä»¶åœ¨åˆæˆæ—¶é—´ï¼Œå®šæ—¶å™¨ä¸­äº§ç”Ÿçš„é”™è¯¯

- ä½¿ç”¨æ–¹å¼

  getDerivedStateFromError é…åˆ componentDidCatch

  ```
  // å£°æ˜å‘¨æœŸå‡½æ•°ï¼Œä¸€æ—¦åå°ç»„ä»¶æŠ¥é”™ï¼Œå°±ä¼šè§¦å‘
  static getDerivedStateFromError(error) {
  	console.log(error)
  	// åœ¨ render ä¹‹å‰è§¦å‘
  	// è¿”å›æ–°çš„state
  	return { hasError: true }
  }
  
  componentDidCatch(error, info) {
  	// ç»Ÿè®¡é¡µé¢çš„é”™è¯¯ï¼Œå‘é€è¯·æ±‚åˆ°åå°
  	console.log(error, info)
  }
  ```

#### ç»„ä»¶é€šä¿¡æ–¹å¼æ€»ç»“

- ç»„ä»¶é—´çš„å…³ç³»

  - çˆ¶å­ç»„ä»¶
  - å…„å¼Ÿç»„ä»¶ï¼ˆéåµŒå¥—ç»„ä»¶ï¼‰
  - ç¥–å­™ç»„ä»¶ï¼ˆè·¨çº§ç»„ä»¶ï¼‰

- å‡ ç§é€šä¿¡æ–¹å¼

  ```javascript
  1. props
  	children props  (æ’æ§½)
  	render props  (æ’æ§½)
  2. æ¶ˆæ¯è®¢é˜…-å‘å¸ƒ
  	pubs-subã€ eventç­‰ç­‰
  3. é›†ä¸­å¼ç®¡ç†
  	reduxã€dvaç­‰ç­‰
  4. conText
  	ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼
  ```

- æ¯”è¾ƒå¥½çš„æ­é…æ–¹å¼

  ```
  çˆ¶å­ç»„ä»¶ï¼š props
  å…„å¼Ÿç»„ä»¶ï¼š æ¶ˆæ¯è®¢é˜…ï¼Œ é›†ä¸­å¼ç®¡ç†
  ç¥–å­™ç»„ä»¶ï¼ˆè·¨çº§ç»„ä»¶ï¼‰ï¼š æ¶ˆæ¯è®¢é˜…-å‘å¸ƒã€é›†ä¸­å¼ç®¡ç†ã€conTextï¼ˆå¼€å‘ç”¨çš„å°‘ï¼Œå°è£…æ’æ¶ç”¨çš„å¤šï¼‰
  ```

## ReactRouter6

#### æ¦‚è¿°

> åœ¨2021å¹´11æœˆï¼ŒReactå°†ReactRouter6è°ƒæ•´ä¸ºReactRouterçš„é»˜è®¤ç‰ˆæœ¬

1. React Router ä»¥3ä¸ªä¸åŒçš„åŒ…å‘å¸ƒåˆ°npmä¸Šï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯
   - react-router: è·¯ç”±çš„æ ¸å¿ƒåº“ï¼Œæä¾›äº†å¾ˆå¤šçš„ç»„ä»¶å’Œé’©å­
   - react-router-dom: åŒ…å«äº†react-routeræ‰€æœ‰å†…å®¹ï¼Œå¹¶æ·»åŠ äº†ä¸€äº›ä¸“é—¨ç”¨äºDOMçš„ç»„ä»¶ï¼Œä¾‹å¦‚<BrowserRouter/>
   - react-router-native: åŒ…æ‹¬react-routeræ‰€æœ‰å†…å®¹ï¼Œå¹¶æ·»åŠ äº†ä¸€äº›ä¸“é—¨ç”¨äºReactNativeçš„APIï¼Œä¾‹å¦‚<NativeRouter/>
2. ä¸React Router5.xç‰ˆæœ¬ï¼Œæ”¹å˜äº†ï¼š
   - å†…ç½®ç»„ä»¶çš„å˜åŒ–ï¼š ç§»é™¤äº† <Switch>, æ–°å¢äº†<Routes>
   - è¯­æ³•çš„å˜åŒ–ï¼šcomponent = {About}, å˜ä¸ºäº† element = {<About/>}ç­‰
   - æ–°å¢äº†å¤šä¸ªhookï¼š useParamsã€useNavigateã€useMatchç­‰
   - å®˜æ–¹æ˜ç¡®æ¨èå‡½æ•°å¼ç»„ä»¶

#### HashRouter BrowserRouter

> ä¸React Router5.xä¸€æ ·

#### Routeså’ŒRoute

1. V6ç‰ˆæœ¬ç§»é™¤äº†å…ˆå‰çš„<Switch/>, å¼•å…¥äº†æ–°çš„æ›¿ä»£è€…<Routes>
2. <Routes>å’Œ<Route>è¦é…åˆä½¿ç”¨
3. <Route/> ç›¸å½“äºä¸€ä¸ª ifè¯­å¥ï¼Œ å¦‚æœå…¶è·¯å¾„ä¸å½“å‰URLåŒ¹é…ï¼Œåˆ™å‘ˆç°å…¶å¯¹åº”çš„ç»„ä»¶
4. å±æ€§ç”¨äºæŒ‡å®šï¼š åŒ¹é…æ—¶æ˜¯å¦åŒºåˆ†å¤§å°å†™ï¼ˆé»˜è®¤ä¸ºfalseï¼‰
5. å½“URlå‘ç”Ÿå˜åŒ–æ—¶ï¼Œ<Routes>éƒ½ä¼šç›´æ¥æŸ¥çœ‹å…¶æ‰€æœ‰å­<Route>å…ƒç´ ä»¥æ‰¾åˆ°æœ€ä½³åŒ¹é…å¹¶å‘ˆç°ç»„ä»¶
6. <Route>ä¹Ÿå¯ä»¥åµŒå¥—ä½¿ç”¨ï¼Œä¸”å¯ä»¥é…åˆuseRoutes() é…ç½®â€œè·¯ç”±è¡¨â€ï¼Œ ä½†éœ€è¦é€šè¿‡<Outlet>ç»„ä»¶æ¥æ¸²æŸ“å…¶å­è·¯ç”±

#### NavLinké«˜äº®

> ç°åœ¨className å¯ä»¥ä½¿ç”¨å›è°ƒå‡½æ•°æ¥å†™ï¼Œå›è°ƒæ¥å—ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œé‡Œé¢ä¼šæœ‰ä¸€ä¸ªåä¸ºisActiveçš„å±æ€§æ¥æ ‡è¯†å½“å‰é“¾æ¥æ˜¯å¦å¤„äºè¢«é€‰ä¸­çŠ¶æ€ï¼Œå‡½æ•°éœ€è¦ä¸€ä¸ªè¿”å›ä¸€ä¸ªstyle

### è·¯ç”±ä¼ å‚

| React Router 5.x | React Router 6  (hooks) |
| :--------------: | :---------------------: |
|      params      |        useParams        |
|      match       |        useMatch         |
|      search      |     useSearchParms      |
|      state       |       useLocation       |

#### ç¼–ç¨‹å¼è·¯ç”±å¯¼èˆª

- **useNavigate**é’©å­å®ç°ç¼–ç¨‹å¼è·¯ç”±è·³è½¬

#### useInRouterContext

> åˆ¤æ–­å½“å‰è·¯ç”±æ˜¯å¦å¤„äºè·¯ç”±ä¸Šä¸‹æ–‡ä¸­ï¼Œå³å½“å‰ç»„ä»¶æ˜¯å¦åŒ…å«åœ¨BrowserRouter æˆ–è€… HashRouter çš„æ ‡ç­¾ä¸­

#### useNavigationType

> è¿”å›å½“å‰çš„å¯¼èˆªç±»å‹ï¼Œå³ç”¨æˆ·æ˜¯å¦‚ä½•æ¥åˆ°å½“å‰é¡µé¢çš„ï¼Œä¼šè¿”å›POPï¼ŒPUSHï¼ŒREPLACE ä¸­çš„ä¸€ä¸ªï¼Œ POPæŒ‡çš„æ˜¯ç›´æ¥åœ¨æµè§ˆå™¨ä¸­ç›´æ¥æ‰“å¼€äº†è¿™ä¸ªè·¯ç”±ç»„ä»¶ï¼ˆåˆ·æ–°é¡µé¢ï¼‰

#### useOutlet

> ç”¨æ¥å‘ˆç°å½“å‰ç»„ä»¶ä¸­æ¸²æŸ“çš„åµŒå¥—è·¯ç”±

#### useResolvedPath

> ç»™å®šä¸€ä¸ªURLå€¼ï¼Œè§£æå…¶ä¸­çš„pathã€searchã€hashå€¼









## å‚è€ƒ

- [React ä¸­æ–‡æ–‡æ¡£](https://zh-hans.reactjs.org/docs/getting-started.html)
- [Redux ä¸­æ–‡æ–‡æ¡£](http://cn.redux.js.org/)
- [React Router å®˜ç½‘](https://reactrouter.com/web/guides/quick-start) è‹±æ–‡ç‰ˆ
- [React é«˜é˜¶ç»„ä»¶(HOC)çš„å…¥é—¨ ğŸ“– åŠå®è·µ ğŸ’»](https://juejin.cn/post/6844904050236850184)
- [react-redux çš„ç®€å•ä½¿ç”¨](https://zhuanlan.zhihu.com/p/62417038)
- [react è·¯ç”±ä¼ å‚åŠå…¶åŒºåˆ«](https://segmentfault.com/a/1190000023554534)
- [å­¦ä¹ ç¬”è®°1](https://docs.qq.com/doc/DSG1jdUJtQ3FYR1V1)
- [å­¦ä¹ ç¬”è®°2](https://docs.qq.com/doc/DSGhGZk9PUm1KVldv)
